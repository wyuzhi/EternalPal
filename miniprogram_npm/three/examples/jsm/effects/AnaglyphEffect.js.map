{"version":3,"file":"node_modules/three/examples/jsm/effects/AnaglyphEffect.js","names":["LinearFilter","Matrix3","NearestFilter","RGBAFormat","ShaderMaterial","StereoCamera","WebGLRenderTarget","FullScreenQuad","AnaglyphEffect","constructor","renderer","width","height","this","colorMatrixLeft","fromArray","colorMatrixRight","_stereo","_params","minFilter","magFilter","format","_renderTargetL","_renderTargetR","_material","uniforms","mapLeft","value","texture","mapRight","vertexShader","join","fragmentShader","_quad","setSize","pixelRatio","getPixelRatio","render","scene","camera","currentRenderTarget","getRenderTarget","matrixWorldAutoUpdate","updateMatrixWorld","parent","update","setRenderTarget","clear","cameraL","cameraR","dispose"],"sources":["node_modules/three/examples/jsm/effects/AnaglyphEffect.js"],"sourcesContent":["import {\n\tLinearFilter,\n\tMatrix3,\n\tNearestFilter,\n\tRGBAFormat,\n\tShaderMaterial,\n\tStereoCamera,\n\tWebGLRenderTarget\n} from 'three';\nimport { FullScreenQuad } from '../postprocessing/Pass.js';\n\n/**\n * A class that creates an anaglyph effect.\n *\n * Note that this class can only be used with {@link WebGLRenderer}.\n * When using {@link WebGPURenderer}, use {@link AnaglyphPassNode}.\n *\n * @three_import import { AnaglyphEffect } from 'three/addons/effects/AnaglyphEffect.js';\n */\nclass AnaglyphEffect {\n\n\t/**\n\t * Constructs a new anaglyph effect.\n\t *\n\t * @param {WebGLRenderer} renderer - The renderer.\n\t * @param {number} width - The width of the effect in physical pixels.\n\t * @param {number} height - The height of the effect in physical pixels.\n\t */\n\tconstructor( renderer, width = 512, height = 512 ) {\n\n\t\t// Dubois matrices from https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.7.6968&rep=rep1&type=pdf#page=4\n\n\t\tthis.colorMatrixLeft = new Matrix3().fromArray( [\n\t\t\t0.456100, - 0.0400822, - 0.0152161,\n\t\t\t0.500484, - 0.0378246, - 0.0205971,\n\t\t\t0.176381, - 0.0157589, - 0.00546856\n\t\t] );\n\n\t\tthis.colorMatrixRight = new Matrix3().fromArray( [\n\t\t\t- 0.0434706, 0.378476, - 0.0721527,\n\t\t\t- 0.0879388, 0.73364, - 0.112961,\n\t\t\t- 0.00155529, - 0.0184503, 1.2264\n\t\t] );\n\n\t\tconst _stereo = new StereoCamera();\n\n\t\tconst _params = { minFilter: LinearFilter, magFilter: NearestFilter, format: RGBAFormat };\n\n\t\tconst _renderTargetL = new WebGLRenderTarget( width, height, _params );\n\t\tconst _renderTargetR = new WebGLRenderTarget( width, height, _params );\n\n\t\tconst _material = new ShaderMaterial( {\n\n\t\t\tuniforms: {\n\n\t\t\t\t'mapLeft': { value: _renderTargetL.texture },\n\t\t\t\t'mapRight': { value: _renderTargetR.texture },\n\n\t\t\t\t'colorMatrixLeft': { value: this.colorMatrixLeft },\n\t\t\t\t'colorMatrixRight': { value: this.colorMatrixRight }\n\n\t\t\t},\n\n\t\t\tvertexShader: [\n\n\t\t\t\t'varying vec2 vUv;',\n\n\t\t\t\t'void main() {',\n\n\t\t\t\t'\tvUv = vec2( uv.x, uv.y );',\n\t\t\t\t'\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );',\n\n\t\t\t\t'}'\n\n\t\t\t].join( '\\n' ),\n\n\t\t\tfragmentShader: [\n\n\t\t\t\t'uniform sampler2D mapLeft;',\n\t\t\t\t'uniform sampler2D mapRight;',\n\t\t\t\t'varying vec2 vUv;',\n\n\t\t\t\t'uniform mat3 colorMatrixLeft;',\n\t\t\t\t'uniform mat3 colorMatrixRight;',\n\n\t\t\t\t'void main() {',\n\n\t\t\t\t'\tvec2 uv = vUv;',\n\n\t\t\t\t'\tvec4 colorL = texture2D( mapLeft, uv );',\n\t\t\t\t'\tvec4 colorR = texture2D( mapRight, uv );',\n\n\t\t\t\t'\tvec3 color = clamp(',\n\t\t\t\t'\t\t\tcolorMatrixLeft * colorL.rgb +',\n\t\t\t\t'\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );',\n\n\t\t\t\t'\tgl_FragColor = vec4(',\n\t\t\t\t'\t\t\tcolor.r, color.g, color.b,',\n\t\t\t\t'\t\t\tmax( colorL.a, colorR.a ) );',\n\n\t\t\t\t'\t#include <tonemapping_fragment>',\n\t\t\t\t'\t#include <colorspace_fragment>',\n\n\t\t\t\t'}'\n\n\t\t\t].join( '\\n' )\n\n\t\t} );\n\n\t\tconst _quad = new FullScreenQuad( _material );\n\n\t\t/**\n\t\t * Resizes the effect.\n\t\t *\n\t\t * @param {number} width - The width of the effect in logical pixels.\n\t\t * @param {number} height - The height of the effect in logical pixels.\n\t\t */\n\t\tthis.setSize = function ( width, height ) {\n\n\t\t\trenderer.setSize( width, height );\n\n\t\t\tconst pixelRatio = renderer.getPixelRatio();\n\n\t\t\t_renderTargetL.setSize( width * pixelRatio, height * pixelRatio );\n\t\t\t_renderTargetR.setSize( width * pixelRatio, height * pixelRatio );\n\n\t\t};\n\n\t\t/**\n\t\t * When using this effect, this method should be called instead of the\n\t\t * default {@link WebGLRenderer#render}.\n\t\t *\n\t\t * @param {Object3D} scene - The scene to render.\n\t\t * @param {Camera} camera - The camera.\n\t\t */\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tconst currentRenderTarget = renderer.getRenderTarget();\n\n\t\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\n\t\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t\t_stereo.update( camera );\n\n\t\t\trenderer.setRenderTarget( _renderTargetL );\n\t\t\trenderer.clear();\n\t\t\trenderer.render( scene, _stereo.cameraL );\n\n\t\t\trenderer.setRenderTarget( _renderTargetR );\n\t\t\trenderer.clear();\n\t\t\trenderer.render( scene, _stereo.cameraR );\n\n\t\t\trenderer.setRenderTarget( null );\n\t\t\t_quad.render( renderer );\n\n\t\t\trenderer.setRenderTarget( currentRenderTarget );\n\n\t\t};\n\n\t\t/**\n\t\t * Frees internal resources. This method should be called\n\t\t * when the effect is no longer required.\n\t\t */\n\t\tthis.dispose = function () {\n\n\t\t\t_renderTargetL.dispose();\n\t\t\t_renderTargetR.dispose();\n\n\t\t\t_material.dispose();\n\t\t\t_quad.dispose();\n\n\t\t};\n\n\t}\n\n}\n\nexport { AnaglyphEffect };\n"],"mappings":"OACCA,aACAC,QACAC,cACAC,WACAC,eACAC,aACAC,sBACM,eACEC,mBAAsB,4BAU/B,MAAMC,eASL,WAAAC,CAAaC,EAAUC,EAAQ,IAAKC,EAAS,KAI5CC,KAAKC,iBAAkB,IAAIb,SAAUc,UAAW,CAC/C,OAAY,UAAa,SACzB,SAAY,UAAa,SACzB,SAAY,UAAa,YAG1BF,KAAKG,kBAAmB,IAAIf,SAAUc,UAAW,EAC9C,SAAW,SAAY,UACvB,SAAW,QAAW,SACtB,WAAc,SAAW,SAG5B,MAAME,EAAU,IAAIZ,aAEda,EAAU,CAAEC,UAAWnB,aAAcoB,UAAWlB,cAAemB,OAAQlB,YAEvEmB,EAAiB,IAAIhB,kBAAmBK,EAAOC,EAAQM,GACvDK,EAAiB,IAAIjB,kBAAmBK,EAAOC,EAAQM,GAEvDM,EAAY,IAAIpB,eAAgB,CAErCqB,SAAU,CAETC,QAAW,CAAEC,MAAOL,EAAeM,SACnCC,SAAY,CAAEF,MAAOJ,EAAeK,SAEpCd,gBAAmB,CAAEa,MAAOd,KAAKC,iBACjCE,iBAAoB,CAAEW,MAAOd,KAAKG,mBAInCc,aAAc,CAEb,oBAEA,gBAEA,8BACA,8EAEA,KAECC,KAAM,MAERC,eAAgB,CAEf,6BACA,8BACA,oBAEA,gCACA,iCAEA,gBAEA,mBAEA,4CACA,6CAEA,wBACA,uCACA,iDAEA,yBACA,mCACA,qCAEA,oCACA,mCAEA,KAECD,KAAM,QAIHE,EAAQ,IAAI1B,eAAgBiB,GAQlCX,KAAKqB,QAAU,SAAWvB,EAAOC,GAEhCF,EAASwB,QAASvB,EAAOC,GAEzB,MAAMuB,EAAazB,EAAS0B,gBAE5Bd,EAAeY,QAASvB,EAAQwB,EAAYvB,EAASuB,GACrDZ,EAAeW,QAASvB,EAAQwB,EAAYvB,EAASuB,EAEtD,EASAtB,KAAKwB,OAAS,SAAWC,EAAOC,GAE/B,MAAMC,EAAsB9B,EAAS+B,mBAEA,IAAhCH,EAAMI,uBAAiCJ,EAAMK,oBAE3B,OAAlBJ,EAAOK,SAAoD,IAAjCL,EAAOG,uBAAiCH,EAAOI,oBAE9E1B,EAAQ4B,OAAQN,GAEhB7B,EAASoC,gBAAiBxB,GAC1BZ,EAASqC,QACTrC,EAAS2B,OAAQC,EAAOrB,EAAQ+B,SAEhCtC,EAASoC,gBAAiBvB,GAC1Bb,EAASqC,QACTrC,EAAS2B,OAAQC,EAAOrB,EAAQgC,SAEhCvC,EAASoC,gBAAiB,MAC1Bb,EAAMI,OAAQ3B,GAEdA,EAASoC,gBAAiBN,EAE3B,EAMA3B,KAAKqC,QAAU,WAEd5B,EAAe4B,UACf3B,EAAe2B,UAEf1B,EAAU0B,UACVjB,EAAMiB,SAEP,CAED,SAIQ1C","ignoreList":[]}