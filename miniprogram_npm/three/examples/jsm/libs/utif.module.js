var UTIF={};!function(){"use strict";var r=function(){function r(r){this.message="JPEG error: "+r}return r.prototype=new Error,r.prototype.name="JpegError",r.constructor=r,r}(),e=function(){var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),n=4017,i=799,a=3406,f=2276,o=1567,u=3784,s=5793,l=2896;function v(r){null==r&&(r={}),null==r.w&&(r.w=-1),this.V=r.n,this.N=r.w}function c(r,e){for(var t,n,i,a=0,f=[],o=16;o>0&&!r[o-1];)o--;f.push({children:[],index:0});var u=f[0];for(t=0;t<o;t++){for(n=0;n<r[t];n++){for((u=f.pop()).children[u.index]=e[a];u.index>0;)u=f.pop();for(u.index++,f.push(u);f.length<=t;)f.push(i={children:[],index:0}),u.children[u.index]=i.children,u=i;a++}t+1<o&&(f.push(i={children:[],index:0}),u.children[u.index]=i.children,u=i)}return f[0].children}function d(r,e,t){return 64*((r.P+1)*e+t)}function h(n,i,a,f,o,u,s,l,v,c){null==c&&(c=!1);var h,U,I,g,F,T,_,b,p,m,A,y=a.m,E=a.Z,D=i,M=0,B=0,k=0,P=0,x=0,C=0;function H(){if(B>0)return B--,M>>B&1;if(255===(M=n[i++])){var e=n[i++];if(e){if(220===e&&c){var f=t(n,i+=2);if(i+=2,f>0&&f!==a.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",f)}else if(217===e){if(c){var o=8*x;if(o>0&&o<a.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",o)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new r("unexpected marker")}}return B=7,M>>>7}function L(e){for(var t=e;;){switch(typeof(t=t[H()])){case"number":return t;case"object":continue}throw new r("invalid huffman sequence")}}function S(r){for(var e=0;r>0;)e=e<<1|H(),r--;return e}function G(r){if(1===r)return 1===H()?1:-1;var e=S(r);return e>=1<<r-1?e:e+(-1<<r)+1}function J(r,e,t,n,i){var a=t%y;x=(t/y|0)*r.A+n;var f=a*r.h+i;e(r,d(r,x,f))}function N(r,e,t){x=t/r.P|0;var n=t%r.P;e(r,d(r,x,n))}var O=f.length;for(_=E?0===u?0===l?function(r,e){var t=L(r.J),n=0===t?0:G(t)<<v;r.D[e]=r.Q+=n}:function(r,e){r.D[e]|=H()<<v}:0===l?function(r,t){if(k>0)k--;else for(var n=u,i=s;n<=i;){var a=L(r.i),f=15&a,o=a>>4;if(0!==f){var l=e[n+=o];r.D[t+l]=G(f)*(1<<v),n++}else{if(o<15){k=S(o)+(1<<o)-1;break}n+=16}}}:function(t,n){for(var i,a,f=u,o=s,l=0;f<=o;){var c=n+e[f],d=t.D[c]<0?-1:1;switch(P){case 0:if(l=(a=L(t.i))>>4,0==(i=15&a))l<15?(k=S(l)+(1<<l),P=4):(l=16,P=1);else{if(1!==i)throw new r("invalid ACn encoding");h=G(i),P=l?2:3}continue;case 1:case 2:t.D[c]?t.D[c]+=d*(H()<<v):0==--l&&(P=2===P?3:0);break;case 3:t.D[c]?t.D[c]+=d*(H()<<v):(t.D[c]=h<<v,P=0);break;case 4:t.D[c]&&(t.D[c]+=d*(H()<<v))}f++}4===P&&0==--k&&(P=0)}:function(r,t){var n=L(r.J),i=0===n?0:G(n),a=1;for(r.D[t]=r.Q+=i;a<64;){var f=L(r.i),o=15&f,u=f>>4;if(0!==o){var s=e[a+=u];r.D[t+s]=G(o),a++}else{if(u<15)break;a+=16}}},p=1===O?f[0].P*f[0].c:y*a.R;C<=p;){var W=o?Math.min(p-C,o):p;if(W>0){for(I=0;I<O;I++)f[I].Q=0;if(k=0,1===O)for(U=f[0],T=0;T<W;T++)N(U,_,C),C++;else for(T=0;T<W;T++){for(I=0;I<O;I++)for(m=(U=f[I]).h,A=U.A,g=0;g<A;g++)for(F=0;F<m;F++)J(U,_,C,g,F);C++}}if(B=0,!(b=w(n,i)))break;if(b.u){i=b.offset}if(!(b.M>=65488&&b.M<=65495))break;i+=2}return i-D}function U(e,t,v){var c,d,h,U,I,w,g,F,T,_,b,p,m,A,y,E,D,M=e.$,B=e.D;if(!M)throw new r("missing required Quantization Table.");for(var k=0;k<64;k+=8)T=B[t+k],_=B[t+k+1],b=B[t+k+2],p=B[t+k+3],m=B[t+k+4],A=B[t+k+5],y=B[t+k+6],E=B[t+k+7],T*=M[k],0!=(_|b|p|m|A|y|E)?(_*=M[k+1],b*=M[k+2],p*=M[k+3],m*=M[k+4],A*=M[k+5],y*=M[k+6],E*=M[k+7],d=(c=(c=s*T+128>>8)+(d=s*m+128>>8)+1>>1)-d,D=(h=b)*u+(U=y)*o+128>>8,h=h*o-U*u+128>>8,g=(I=(I=l*(_-E)+128>>8)+(g=A<<4)+1>>1)-g,w=(F=(F=l*(_+E)+128>>8)+(w=p<<4)+1>>1)-w,U=(c=c+(U=D)+1>>1)-U,h=(d=d+h+1>>1)-h,D=I*f+F*a+2048>>12,I=I*a-F*f+2048>>12,F=D,D=w*i+g*n+2048>>12,w=w*n-g*i+2048>>12,g=D,v[k]=c+F,v[k+7]=c-F,v[k+1]=d+g,v[k+6]=d-g,v[k+2]=h+w,v[k+5]=h-w,v[k+3]=U+I,v[k+4]=U-I):(D=s*T+512>>10,v[k]=D,v[k+1]=D,v[k+2]=D,v[k+3]=D,v[k+4]=D,v[k+5]=D,v[k+6]=D,v[k+7]=D);for(var P=0;P<8;++P)T=v[P],0!=((_=v[P+8])|(b=v[P+16])|(p=v[P+24])|(m=v[P+32])|(A=v[P+40])|(y=v[P+48])|(E=v[P+56]))?(d=(c=4112+((c=s*T+2048>>12)+(d=s*m+2048>>12)+1>>1))-d,D=(h=b)*u+(U=y)*o+2048>>12,h=h*o-U*u+2048>>12,U=D,g=(I=(I=l*(_-E)+2048>>12)+(g=A)+1>>1)-g,w=(F=(F=l*(_+E)+2048>>12)+(w=p)+1>>1)-w,D=I*f+F*a+2048>>12,I=I*a-F*f+2048>>12,F=D,D=w*i+g*n+2048>>12,w=w*n-g*i+2048>>12,(T=(c=c+U+1>>1)+F)<16?T=0:T>=4080?T=255:T>>=4,(_=(d=d+h+1>>1)+(g=D))<16?_=0:_>=4080?_=255:_>>=4,(b=(h=d-h)+w)<16?b=0:b>=4080?b=255:b>>=4,(p=(U=c-U)+I)<16?p=0:p>=4080?p=255:p>>=4,(m=U-I)<16?m=0:m>=4080?m=255:m>>=4,(A=h-w)<16?A=0:A>=4080?A=255:A>>=4,(y=d-g)<16?y=0:y>=4080?y=255:y>>=4,(E=c-F)<16?E=0:E>=4080?E=255:E>>=4,B[t+P]=T,B[t+P+8]=_,B[t+P+16]=b,B[t+P+24]=p,B[t+P+32]=m,B[t+P+40]=A,B[t+P+48]=y,B[t+P+56]=E):(D=(D=s*T+8192>>14)<-2040?0:D>=2024?255:D+2056>>4,B[t+P]=D,B[t+P+8]=D,B[t+P+16]=D,B[t+P+24]=D,B[t+P+32]=D,B[t+P+40]=D,B[t+P+48]=D,B[t+P+56]=D)}function I(r,e){for(var t=e.P,n=e.c,i=new Int16Array(64),a=0;a<n;a++)for(var f=0;f<t;f++){U(e,d(e,a,f),i)}return e.D}function w(r,e,n){null==n&&(n=e);var i=r.length-1,a=n<e?n:e;if(e>=i)return null;var f=t(r,e);if(f>=65472&&f<=65534)return{u:null,M:f,offset:e};for(var o=t(r,a);!(o>=65472&&o<=65534);){if(++a>=i)return null;o=t(r,a)}return{u:f.toString(16),M:o,offset:a}}return v.prototype={parse(n,i){null==i&&(i={});var a,f,o=i.F,u=0,s=null,l=null,v=0;function d(){var r=t(n,u),e=(u+=2)+r-2,i=w(n,e,u);i&&i.u&&(e=i.offset);var a=n.subarray(u,e);return u+=a.length,a}function U(r){for(var e=Math.ceil(r.o/8/r.X),t=Math.ceil(r.s/8/r.B),n=0;n<r.W.length;n++){W=r.W[n];var i=Math.ceil(Math.ceil(r.o/8)*W.h/r.X),a=Math.ceil(Math.ceil(r.s/8)*W.A/r.B),f=e*W.h,o=64*(t*W.A)*(f+1);W.D=new Int16Array(o),W.P=i,W.c=a}r.m=e,r.R=t}var g=[],F=[],T=[],_=t(n,u);if(u+=2,65496!==_)throw new r("SOI not found");_=t(n,u),u+=2;r:for(;65497!==_;){var b,p,m;switch(_){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var A=d();65504===_&&74===A[0]&&70===A[1]&&73===A[2]&&70===A[3]&&0===A[4]&&(s={version:{d:A[5],T:A[6]},K:A[7],j:A[8]<<8|A[9],H:A[10]<<8|A[11],S:A[12],I:A[13],C:A.subarray(14,14+3*A[12]*A[13])}),65518===_&&65===A[0]&&100===A[1]&&111===A[2]&&98===A[3]&&101===A[4]&&(l={version:A[5]<<8|A[6],k:A[7]<<8|A[8],q:A[9]<<8|A[10],a:A[11]});break;case 65499:for(var y=t(n,u)+(u+=2)-2;u<y;){var E=n[u++],D=new Uint16Array(64);if(E>>4==0)for(p=0;p<64;p++)D[e[p]]=n[u++];else{if(E>>4!=1)throw new r("DQT - invalid table spec");for(p=0;p<64;p++)D[e[p]]=t(n,u),u+=2}g[15&E]=D}break;case 65472:case 65473:case 65474:if(a)throw new r("Only single frame JPEGs supported");u+=2,(a={}).G=65473===_,a.Z=65474===_,a.precision=n[u++];var M,B=t(n,u),k=0,P=0;u+=2,a.s=o||B,a.o=t(n,u),u+=2,a.W=[],a._={};var x=n[u++];for(b=0;b<x;b++){M=n[u];var C=n[u+1]>>4,H=15&n[u+1];k<C&&(k=C),P<H&&(P=H);var L=n[u+2];m=a.W.push({h:C,A:H,L:L,$:null}),a._[M]=m-1,u+=3}a.X=k,a.B=P,U(a);break;case 65476:var S=t(n,u);for(u+=2,b=2;b<S;){var G=n[u++],J=new Uint8Array(16),N=0;for(p=0;p<16;p++,u++)N+=J[p]=n[u];var O=new Uint8Array(N);for(p=0;p<N;p++,u++)O[p]=n[u];b+=17+N,(G>>4==0?T:F)[15&G]=c(J,O)}break;case 65501:f=t(n,u+=2),u+=2;break;case 65498:var W,j=1==++v&&!o;u+=2;var R=n[u++],Q=[];for(b=0;b<R;b++){var q=n[u++],Z=a._[q];(W=a.W[Z]).index=q;var $=n[u++];W.J=T[$>>4],W.i=F[15&$],Q.push(W)}var V=n[u++],X=n[u++],z=n[u++];try{var Y=h(n,u,a,Q,f,V,X,z>>4,15&z,j);u+=Y}catch(r){if(r instanceof DNLMarkerError)return this.parse(n,{F:r.s});if(r instanceof EOIMarkerError)break r;throw r}break;case 65500:u+=4;break;case 65535:255!==n[u]&&u--;break;default:var K=w(n,u-2,u-3);if(K&&K.u){u=K.offset;break}if(u>=n.length-1)break r;throw new r("JpegImage.parse - unknown marker: "+_.toString(16))}_=t(n,u),u+=2}for(this.width=a.o,this.height=a.s,this.g=s,this.b=l,this.W=[],b=0;b<a.W.length;b++){var rr=g[(W=a.W[b]).L];rr&&(W.$=rr),this.W.push({index:W.index,e:I(0,W),l:W.h/a.X,t:W.A/a.B,P:W.P,c:W.c})}this.p=this.W.length},Y(r,e,t){null==t&&(t=!1);var n,i,a,f,o,u,s,l,v,c,d,h,U=this.width/r,I=this.height/e,w=0,g=this.W.length,F=r*e*g,T=new Uint8ClampedArray(F),_=new Uint32Array(r),b=4294967288;for(s=0;s<g;s++){if(i=(n=this.W[s]).l*U,a=n.t*I,w=s,d=n.e,f=n.P+1<<3,i!==h){for(o=0;o<r;o++)l=0|o*i,_[o]=(l&b)<<3|7&l;h=i}for(u=0;u<e;u++)for(c=f*((l=0|u*a)&b)|(7&l)<<3,o=0;o<r;o++)T[w]=d[c+_[o]],w+=g}var p=this.V;if(t||4!==g||p||(p=new Int32Array([-256,255,-256,255,-256,255,-256,255])),p)for(s=0;s<F;)for(l=0,v=0;l<g;l++,s++,v+=2)T[s]=(T[s]*p[v]>>8)+p[v+1];return T},get f(){return this.b?!!this.b.a:3===this.p?0!==this.N&&(82!==this.W[0].index||71!==this.W[1].index||66!==this.W[2].index):1===this.N},z:function(r){for(var e,t,n,i=0,a=r.length;i<a;i+=3)e=r[i],t=r[i+1],n=r[i+2],r[i]=e-179.456+1.402*n,r[i+1]=e+135.459-.344*t-.714*n,r[i+2]=e-226.816+1.772*t;return r},O:function(r){for(var e,t,n,i,a=0,f=0,o=r.length;f<o;f+=4)e=r[f],t=r[f+1],n=r[f+2],i=r[f+3],r[a++]=t*(-660635669420364e-19*t+.000437130475926232*n-54080610064599e-18*e+.00048449797120281*i-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*e-.00477271405408747*i+1.53380253221734)+e*(.000961250184130688*e-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),r[a++]=107.268039397724+t*(219927104525741e-19*t-.000640992018297945*n+.000659397001245577*e+.000426105652938837*i-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*e+.000770482631801132*i-.151051492775562)+e*(.00126935368114843*e-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),r[a++]=t*(-.000570115196973677*t-263409051004589e-19*n+.0020741088115012*e-.00288260236853442*i+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*e+.000560833691242812*i-.195152027534049)+e*(.00174418132927582*e-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return r.subarray(0,a)},r:function(r){for(var e,t,n,i=0,a=r.length;i<a;i+=4)e=r[i],t=r[i+1],n=r[i+2],r[i]=434.456-e-1.402*n,r[i+1]=119.541-e+.344*t+.714*n,r[i+2]=481.816-e-1.772*t;return r},U:function(r){for(var e,t,n,i,a=0,f=0,o=r.length;f<o;f+=4)e=r[f],t=r[f+1],n=r[f+2],i=r[f+3],r[a++]=255+e*(-6747147073602441e-20*e+.0008379262121013727*t+.0002894718188643294*n+.003264231057537806*i-1.1185611867203937)+t*(26374107616089405e-21*t-8626949158638572e-20*n-.0002748769067499491*i-.02155688794978967)+n*(-3878099212869363e-20*n-.0003267808279485286*i+.0686742238595345)-i*(.0003361971776183937*i+.7430659151342254),r[a++]=255+e*(.00013596372813588848*e+.000924537132573585*t+.00010567359618683593*n+.0004791864687436512*i-.3109689587515875)+t*(-.00023545346108370344*t+.0002702845253534714*n+.0020200308977307156*i-.7488052167015494)+n*(6834815998235662e-20*n+.00015168452363460973*i-.09751927774728933)-i*(.0003189131175883281*i+.7364883807733168),r[a++]=255+e*(13598650411385307e-21*e+.00012423956175490851*t+.0004751985097583589*n-36729317476630422e-22*i-.05562186980264034)+t*(.00016141380598724676*t+.0009692239130725186*n+.0007782692450036253*i-.44015232367526463)+n*(5.068882914068769e-7*n+.0017778369011375071*i-.7591454649749609)-i*(.0003435319965105553*i+.7063770186160144);return r.subarray(0,a)},getData:function(e){var t=e.width,n=e.height,i=e.forceRGB,a=e.isSourcePDF;if(this.p>4)throw new r("Unsupported color mode");var f=this.Y(t,n,a);if(1===this.p&&i){for(var o=f.length,u=new Uint8ClampedArray(3*o),s=0,l=0;l<o;l++){var v=f[l];u[s++]=v,u[s++]=v,u[s++]=v}return u}if(3===this.p&&this.f)return this.z(f);if(4===this.p){if(this.f)return i?this.O(f):this.r(f);if(i)return this.U(f)}return f}},v}();function t(r,e){return r[e]<<8|r[e+1]}UTIF.JpegDecoder=e}(),UTIF.encodeImage=function(r,e,t,n){var i={t256:[e],t257:[t],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[t],t279:[e*t*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(n)for(var a in n)i[a]=n[a];var f=new Uint8Array(UTIF.encode([i])),o=new Uint8Array(r),u=new Uint8Array(1e3+e*t*4);for(a=0;a<f.length;a++)u[a]=f[a];for(a=0;a<o.length;a++)u[1e3+a]=o[a];return u.buffer},UTIF.encode=function(r){var e=new Uint8Array(2e4),t=4,n=UTIF._binBE;e[0]=e[1]=77,n.writeUshort(e,2,42);var i=8;n.writeUint(e,t,i),t+=4;for(var a=0;a<r.length;a++){var f=UTIF._writeIFD(n,UTIF._types.basic,e,i,r[a]);i=f[1],a<r.length-1&&(0!=(3&i)&&(i+=4-(3&i)),n.writeUint(e,f[0],i))}return e.slice(0,i).buffer},UTIF.decode=function(r,e){null==e&&(e={parseMN:!0,debug:!1});var t=new Uint8Array(r),n=0,i=UTIF._binBE.readASCII(t,n,2);n+=2;var a="II"==i?UTIF._binLE:UTIF._binBE;a.readUshort(t,n);n+=2;var f=a.readUint(t,n);n+=4;for(var o=[];;){var u=a.readUshort(t,f),s=a.readUshort(t,f+4);if(0!=u&&(s<1||13<s)){log("error in TIFF");break}if(UTIF._readIFD(a,t,f,o,0,e),0==(f=a.readUint(t,f+2+12*u)))break}return o},UTIF.decodeImage=function(r,e,t){if(!e.data){var n=new Uint8Array(r),i=UTIF._binBE.readASCII(n,0,2);if(null!=e.t256){e.isLE="II"==i,e.width=e.t256[0],e.height=e.t257[0];var a=e.t259?e.t259[0]:1,f=e.t266?e.t266[0]:1;e.t284&&2==e.t284[0]&&log("PlanarConfiguration 2 should not be used!"),7==a&&e.t258&&e.t258.length>3&&(e.t258=e.t258.slice(0,3));var o=e.t277?e.t277[0]:1,u=(e.t258?e.t258[0]:1)*o;1==a&&null!=e.t279&&e.t278&&32803==e.t262[0]&&(u=Math.round(8*e.t279[0]/(e.width*e.t278[0]))),e.t50885&&4==e.t50885[0]&&(u=3*e.t258[0]);var s=8*Math.ceil(e.width*u/8),l=e.t273;(null==l||e.t322)&&(l=e.t324);var v=e.t279;1==a&&1==l.length&&(v=[e.height*(s>>>3)]),(null==v||e.t322)&&(v=e.t325);var c=new Uint8Array(e.height*(s>>>3)),d=0;if(null!=e.t322){var h=e.t322[0],U=e.t323[0],I=Math.floor((e.width+h-1)/h),w=Math.floor((e.height+U-1)/U),g=new Uint8Array(0|Math.ceil(h*U*u/8));console.log("====",I,w);for(var F=0;F<w;F++)for(var T=0;T<I;T++){var _=F*I+T;g.fill(0),UTIF.decode._decompress(e,t,n,l[_],v[_],a,g,0,f,h,U),6==a?c=g:UTIF._copyTile(g,0|Math.ceil(h*u/8),U,c,0|Math.ceil(e.width*u/8),e.height,0|Math.ceil(T*h*u/8),F*U)}d=8*c.length}else{if(null==l)return;var b=e.t278?e.t278[0]:e.height;b=Math.min(b,e.height);for(_=0;_<l.length;_++)UTIF.decode._decompress(e,t,n,l[_],v[_],a,c,0|Math.ceil(d/8),f,e.width,b),d+=s*b;d=Math.min(d,8*c.length)}e.data=new Uint8Array(c.buffer,0,0|Math.ceil(d/8))}}},UTIF.decode._decompress=function(r,e,t,n,i,a,f,o,u,s,l){if(r.t271&&"Panasonic"==r.t271[0]&&r.t45&&6==r.t45[0]&&(a=34316),1==a)for(var v=0;v<i;v++)f[o+v]=t[n+v];else if(2==a)UTIF.decode._decodeG2(t,n,i,f,o,s,u);else if(3==a)UTIF.decode._decodeG3(t,n,i,f,o,s,u,!!r.t292&&1==(1&r.t292[0]));else if(4==a)UTIF.decode._decodeG4(t,n,i,f,o,s,u);else if(5==a)UTIF.decode._decodeLZW(t,n,i,f,o,8);else if(6==a)UTIF.decode._decodeOldJPEG(r,t,n,i,f,o);else if(7==a||34892==a)UTIF.decode._decodeNewJPEG(r,t,n,i,f,o);else if(8==a||32946==a){var c=new Uint8Array(t.buffer,n+2,i-6),d=UTIF._inflateRaw(c);o+d.length<=f.length&&f.set(d,o)}else 9==a?UTIF.decode._decodeVC5(t,n,i,f,o,r.t33422):32767==a?UTIF.decode._decodeARW(r,t,n,i,f,o):32773==a?UTIF.decode._decodePackBits(t,n,i,f,o):32809==a?UTIF.decode._decodeThunder(t,n,i,f,o):34316==a?UTIF.decode._decodePanasonic(r,t,n,i,f,o):34713==a?UTIF.decode._decodeNikon(r,e,t,n,i,f,o):34676==a?UTIF.decode._decodeLogLuv32(r,t,n,i,f,o):log("Unknown compression",a);var h=r.t258?Math.min(32,r.t258[0]):1,U=r.t277?r.t277[0]:1,I=h*U>>>3,w=Math.ceil(h*U*s/8);if(16==h&&!r.isLE&&null==r.t33422)for(var g=0;g<l;g++)for(var F=o+g*w,T=1;T<w;T+=2){var _=f[F+T];f[F+T]=f[F+T-1],f[F+T-1]=_}if(r.t317&&2==r.t317[0])for(g=0;g<l;g++){var b=o+g*w;if(16==h)for(v=I;v<w;v+=2){var p=(f[b+v+1]<<8|f[b+v])+(f[b+v-I+1]<<8|f[b+v-I]);f[b+v]=255&p,f[b+v+1]=p>>>8&255}else if(3==U)for(v=3;v<w;v+=3)f[b+v]=f[b+v]+f[b+v-3]&255,f[b+v+1]=f[b+v+1]+f[b+v-2]&255,f[b+v+2]=f[b+v+2]+f[b+v-1]&255;else for(v=I;v<w;v++)f[b+v]=f[b+v]+f[b+v-I]&255}},UTIF.decode._decodePanasonic=function(r,e,t,n,i,a){var f,o,u,s,l,v,c,d,h=e.buffer,U=r.t2[0],I=r.t3[0],w=r.t10[0],g=r.t45[0],F=0,T=0,_=0,b=0,p=6==g?new Uint32Array(18):new Uint8Array(16),m=[0,0],A=[0,0],y=0,E=new Uint8Array(16384),D=new Uint16Array(i.buffer);function M(r){if(0==_){var e=new Uint8Array(h,t+T+8184,8200),n=new Uint8Array(h,t+T,8184);E.set(e),E.set(n,e.length),T+=16384}if(5!=g)return(E[b=(_=_-r&131071)>>3^16368]|E[b+1]<<8)>>(7&_)&~(-1<<r);for(f=0;f<16;f++)p[f]=E[_++],_&=16383}function B(r){return E[_+15-r]}function k(){m[0]=0,m[1]=0,A[0]=0,A[1]=0}if(7==g)throw g;if(6==g){var P=12==w,x=P?function(){p[0]=B(0)<<4|B(1)>>4,p[1]=4095&((15&B(1))<<8|B(2)),p[2]=B(3)>>6&3,p[3]=(63&B(3))<<2|B(4)>>6,p[4]=(63&B(4))<<2|B(5)>>6,p[5]=(63&B(5))<<2|B(6)>>6,p[6]=B(6)>>4&3,p[7]=(15&B(6))<<4|B(7)>>4,p[8]=(15&B(7))<<4|B(8)>>4,p[9]=(15&B(8))<<4|B(9)>>4,p[10]=B(9)>>2&3,p[11]=(3&B(9))<<6|B(10)>>2,p[12]=(3&B(10))<<6|B(11)>>2,p[13]=(3&B(11))<<6|B(12)>>2,p[14]=3&B(12),p[15]=B(13),p[16]=B(14),p[17]=B(15),_+=16,b=0}:function(){p[0]=B(0)<<6|B(1)>>2,p[1]=16383&((3&B(1))<<12|B(2)<<4|B(3)>>4),p[2]=B(3)>>2&3,p[3]=(3&B(3))<<8|B(4),p[4]=B(5)<<2|B(6)>>6,p[5]=(63&B(6))<<4|B(7)>>4,p[6]=B(7)>>2&3,p[7]=(3&B(7))<<8|B(8),p[8]=B(9)<<2&1020|B(10)>>6,p[9]=1023&(B(10)<<4|B(11)>>4),p[10]=B(11)>>2&3,p[11]=(3&B(11))<<8|B(12),p[12]=1023&(B(13)<<2&1020|B(14)>>6),p[13]=1023&(B(14)<<4|B(15)>>4),_+=16,b=0},C=P?14:11,H=P?128:512,L=P?2048:8192,S=P?16383:65535,G=P?4095:16383,J=U/C,N=16*J,O=P?18:14;for(v=0;v<I-15;v+=16){var W=Math.min(16,I-v),j=N*W;for(E=new Uint8Array(h,t+F,j),_=0,F+=j,d=0,c=0;d<W;d++,c=0){y=(v+d)*U;for(var R=0;R<J;R++)for(x(),k(),u=0,l=0,f=0;f<C;f++){if(s=1&f,f%3==2){var Q=b<O?p[b++]:0;3==Q&&(Q=4),l=H<<Q,u=1<<Q}var q=b<O?p[b++]:0;m[s]?(q*=u,l<L&&A[s]>l&&(q+=A[s]-l),A[s]=q):(m[s]=q,q?A[s]=q:q=A[s]),D[y+c++]=q-15<=S?q-15&S:q+2147483633>>31&G}}}}else if(5==g){var Z=12==w?10:9;for(v=0;v<I;v++)for(c=0;c<U;c+=Z)M(0),12==w?(D[y++]=((15&p[1])<<8)+p[0],D[y++]=16*p[2]+(p[1]>>4),D[y++]=((15&p[4])<<8)+p[3],D[y++]=16*p[5]+(p[4]>>4),D[y++]=((15&p[7])<<8)+p[6],D[y++]=16*p[8]+(p[7]>>4),D[y++]=((15&p[10])<<8)+p[9],D[y++]=16*p[11]+(p[10]>>4),D[y++]=((15&p[13])<<8)+p[12],D[y++]=16*p[14]+(p[13]>>4)):14==w&&(D[y++]=p[0]+((63&p[1])<<8),D[y++]=(p[1]>>6)+4*p[2]+((15&p[3])<<10),D[y++]=(p[3]>>4)+16*p[4]+((3&p[5])<<12),D[y++]=((252&p[5])>>2)+(p[6]<<6),D[y++]=p[7]+((63&p[8])<<8),D[y++]=(p[8]>>6)+4*p[9]+((15&p[10])<<10),D[y++]=(p[10]>>4)+16*p[11]+((3&p[12])<<12),D[y++]=((252&p[12])>>2)+(p[13]<<6),D[y++]=p[14]+((63&p[15])<<8))}else{if(4!=g)throw g;for(v=0;v<I;v++)for(c=0;c<U;c++)s=1&(f=c%14),0==f&&k(),f%3==2&&(u=4>>3-M(2)),A[s]?0!=(o=M(8))&&(m[s]-=128<<u,(m[s]<0||4==u)&&(m[s]&=~(-1<<u)),m[s]+=o<<u):(A[s]=M(8),(A[s]||f>11)&&(m[s]=A[s]<<4|M(4))),D[y++]=m[1&c]}},UTIF.decode._decodeVC5=function(){var r,e,t,n=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],i=[3,3,3,3,2,2,2,1,1,1];function a(r){var e=r[1],t=r[0][e>>>3]>>>7-(7&e)&1;return r[1]++,t}function f(e,t){if(null==r){r={};for(var i=0;i<n.length;i+=4)r[n[i+1]]=n.slice(i,i+4)}for(var f=a(e),o=r[f];null==o;)f=f<<1|a(e),o=r[f];var u=o[3];0!=u&&(u=0==a(e)?u:-u),t[0]=o[2],t[1]=u}function o(r,e){for(var t=0;t<e;t++)1==(1&r)&&r++,r>>>=1;return r}function u(r,e){return r>>e}function s(r,e,t,n,i,a){e[t]=u(u(11*r[i]-4*r[i+a]+r[i+a+a]+4,3)+r[n],1),e[t+a]=u(u(5*r[i]+4*r[i+a]-r[i+a+a]+4,3)-r[n],1)}function l(r,e,t,n,i,a){var f=r[i-a]-r[i+a],o=r[i],s=r[n];e[t]=u(u(f+4,3)+o+s,1),e[t+a]=u(u(4-f,3)+o-s,1)}function v(r,e,t,n,i,a){e[t]=u(u(5*r[i]+4*r[i-a]-r[i-a-a]+4,3)+r[n],1),e[t+a]=u(u(11*r[i]-4*r[i-a]+r[i-a-a]+4,3)-r[n],1)}function c(r){return r=t[r=r<0?0:r>4095?4095:r]>>>2}return function(r,n,a,u,d,h){u=new Uint16Array(u.buffer);var U,I,w,g,F,T,_,b,p=Date.now(),m=UTIF._binBE,A=n+a;n+=4;for(var y=1==h[0];n<A;){var E=m.readShort(r,n),D=m.readUshort(r,n+2);if(n+=4,12==E)H=D;else if(20==E)U=D;else if(21==E)I=D;else if(48==E)w=D;else if(53==E)g=D;else if(35==E)D;else if(62==E)F=D;else if(101==E)D;else if(109==E)T=D;else if(84==E)D;else if(106==E)D;else if(107==E)D;else if(108==E)D;else if(102==E)D;else if(104==E)er=D;else if(105==E)D;else{var M=E<0?-E:E,B=65280&M,k=0;if(24576&M&&(8192&M?(k=65535&D,k+=(255&M)<<16):k=65535&D),24576==(24576&M)){if(null==_){_=[];for(var P=0;P<4;P++)_[P]=new Int16Array((U>>>1)*(I>>>1));b=new Int16Array((U>>>1)*(I>>>1)),e=new Int16Array(1024);for(P=0;P<1024;P++){var x=P-512,C=Math.abs(x),H=Math.floor(768*C*C*C/16581375)+C;e[P]=Math.sign(x)*H}t=new Uint16Array(4096);for(P=0;P<4096;P++){var L=P,S=65535*(Math.pow(113,L/4095)-1)/112;t[P]=Math.min(S,65535)}}var G=_[F],J=o(U,1+i[w]),N=o(I,1+i[w]);if(0==w)for(var O=0;O<N;O++)for(var W=0;W<J;W++){var j=n+2*(O*J+W);G[O*(U>>>1)+W]=r[j]<<8|r[j+1]}else{var R=[r,8*n],Q=[],q=0,Z=J*N,$=[0,0],V=0;for(D=0;q<Z;)for(f(R,$),V=$[0],D=$[1];V>0;)Q[q++]=D,V--;var X=(w-1)%3,z=1!=X?J:0,Y=0!=X?N:0;for(O=0;O<N;O++){var K=(O+Y)*(U>>>1)+z,rr=O*J;for(W=0;W<J;W++)G[K+W]=e[Q[rr+W]+512]*g}if(2==X){var er=U>>>1,tr=2*J,nr=2*N;for(O=0;O<N;O++)for(W=0;W<tr;W++){P=2*O*er+W;var ir=N*er+(fr=O*er+W);0==O?s(G,b,P,ir,fr,er):O==N-1?v(G,b,P,ir,fr,er):l(G,b,P,ir,fr,er)}var ar=G;G=b,b=ar;for(O=0;O<nr;O++)for(W=0;W<J;W++){var fr;P=O*er+2*W,ir=J+(fr=O*er+W);0==W?s(G,b,P,ir,fr,1):W==J-1?v(G,b,P,ir,fr,1):l(G,b,P,ir,fr,1)}ar=G;G=b,b=ar;for(var or=[],ur=2-~~((w-1)/3),sr=0;sr<3;sr++)or[sr]=T>>14-2*sr&3;var lr=or[ur];if(0!=lr)for(O=0;O<nr;O++)for(W=0;W<tr;W++){G[P=O*er+W]=G[P]<<lr}}}if(9==w&&3==F){var vr=_[0],cr=_[1],dr=_[2],hr=_[3];for(O=0;O<I;O+=2)for(W=0;W<U;W+=2){var Ur=O*U+W,Ir=vr[j=(O>>>1)*(U>>>1)+(W>>>1)],wr=cr[j]-2048,gr=dr[j]-2048,Fr=hr[j]-2048,Tr=(wr<<1)+Ir,_r=(gr<<1)+Ir,br=Ir+Fr,pr=Ir-Fr;y?(u[Ur]=c(br),u[Ur+1]=c(_r),u[Ur+U]=c(Tr),u[Ur+U+1]=c(pr)):(u[Ur]=c(Tr),u[Ur+1]=c(br),u[Ur+U]=c(pr),u[Ur+U+1]=c(_r))}}n+=4*k}else if(16388==M)n+=4*k;else if(8192!=B&&8448!=B&&9216!=B)throw M.toString(16)}}console.log(Date.now()-p)}}(),UTIF.decode._decodeLogLuv32=function(r,e,t,n,i,a){for(var f=r.width,o=4*f,u=0,s=new Uint8Array(o);u<n;){for(var l=0;l<o;){var v=e[t+u];if(u++,v<128){for(var c=0;c<v;c++)s[l+c]=e[t+u+c];l+=v,u+=v}else{v-=126;for(c=0;c<v;c++)s[l+c]=e[t+u];l+=v,u++}}for(var d=0;d<f;d++)i[a+0]=s[d],i[a+1]=s[d+f],i[a+2]=s[d+2*f],i[a+4]=s[d+3*f],a+=6}},UTIF.decode._ljpeg_diff=function(r,e,t){var n,i,a=UTIF.decode._getbithuff;return n=a(r,e,t[0],t),0==((i=a(r,e,n,0))&1<<n-1)&&(i-=(1<<n)-1),i},UTIF.decode._decodeARW=function(r,e,t,n,i,a){var f=r.t256[0],o=r.t257[0],u=r.t258[0],s=r.isLE?UTIF._binLE:UTIF._binBE;if(f*o==n||f*o*1.5==n)if(f*o*1.5!=n){var l,v,c,d,h,U,I,w,g=new Uint16Array(16),F=new Uint8Array(f+1);for(E=0;E<o;E++){for(var T=0;T<f;T++)F[T]=e[t++];for(w=0,y=0;y<f-30;w+=16){for(v=2047&(l=s.readUint(F,w)),c=2047&l>>>11,d=15&l>>>22,h=15&l>>>26,U=0;U<4&&128<<U<=v-c;U++);for(I=30,_=0;_<16;_++)_==d?g[_]=v:_==h?g[_]=c:(g[_]=((s.readUshort(F,w+(I>>3))>>>(7&I)&127)<<U)+c,g[_]>2047&&(g[_]=2047),I+=7);for(_=0;_<16;_++,y+=2){H=g[_]<<1;UTIF.decode._putsF(i,(E*f+y)*u,H<<16-u)}y-=1&y?1:31}}}else for(var _=0;_<n;_+=3){var b=e[t+_+0],p=e[t+_+1],m=e[t+_+2];i[a+_]=p<<4|b>>>4,i[a+_+1]=b<<4|m>>>4,i[a+_+2]=m<<4|p>>>4}else{o+=8;var A,y,E,D=[t,0,0,0],M=new Uint16Array(32770),B=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],k=0,P=UTIF.decode._ljpeg_diff;for(M[0]=15,A=_=0;_<18;_++)for(var x=32768>>>(B[_]>>>8),C=0;C<x;C++)M[++A]=B[_];for(y=f;y--;)for(E=0;E<o+1;E+=2)if(E==o&&(E=1),k+=P(e,D,M),E<o){var H=4095&k;UTIF.decode._putsF(i,(E*f+y)*u,H<<16-u)}}},UTIF.decode._decodeNikon=function(r,e,t,n,i,a,f){var o=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],u=r.t256[0],s=r.t257[0],l=r.t258[0],v=0,c=0,d=UTIF.decode._make_decoder,h=UTIF.decode._getbithuff,U=e[0].exifIFD.makerNote,I=U.t150?U.t150:U.t140,w=0,g=I[w++],F=I[w++];73!=g&&88!=F||(w+=2110),70==g&&(v=2),14==l&&(v+=3);for(var T=[[0,0],[0,0]],_=r.isLE?UTIF._binLE:UTIF._binBE,b=0;b<2;b++)for(var p=0;p<2;p++)T[b][p]=_.readShort(I,w),w+=2;var m,A,y,E,D,M=1<<l&32767,B=0,k=_.readShort(I,w);w+=2,k>1&&(B=Math.floor(M/(k-1))),68==g&&32==F&&B>0&&(c=_.readShort(I,562));var P=[0,0],x=d(o[v]),C=[n,0,0,0];for(m=0;m<s;m++)for(c&&m==c&&(x=d(o[v+1])),A=0;A<u;A++){b=h(t,C,x[0],x),0==((D=1+(h(t,C,(y=15&b)-(E=b>>>4),0)<<1)<<E>>>1)&1<<y-1)&&(D-=(1<<y)-(0==E?1:0)),A<2?P[A]=T[1&m][A]+=D:P[1&A]+=D;var H=Math.min(Math.max(P[1&A],0),(1<<l)-1),L=(m*u+A)*l;UTIF.decode._putsF(a,L,H<<16-l)}},UTIF.decode._putsF=function(r,e,t){t<<=8-(7&e);var n=e>>>3;r[n]|=t>>>16,r[n+1]|=t>>>8,r[n+2]|=t},UTIF.decode._getbithuff=function(r,e,t,n){UTIF.decode._get_byte;var i,a=e[0],f=e[1],o=e[2],u=e[3];if(0==t||o<0)return 0;for(;!u&&o<t&&-1!=(i=r[a++])&&!(u=0);)f=(f<<8)+i,o+=8;if(i=f<<32-o>>>32-t,n?(o-=n[i+1]>>>8,i=255&n[i+1]):o-=t,o<0)throw"e";return e[0]=a,e[1]=f,e[2]=o,e[3]=u,i},UTIF.decode._make_decoder=function(r){var e,t,n,i,a,f=[];for(e=16;0!=e&&!r[e];e--);var o=17;for(f[0]=e,n=t=1;t<=e;t++)for(i=0;i<r[t];i++,++o)for(a=0;a<1<<e-t;a++)n<=1<<e&&(f[n++]=t<<8|r[o]);return f},UTIF.decode._decodeNewJPEG=function(r,e,t,n,i,a){n=Math.min(n,e.length-t);var f=r.t347,o=f?f.length:0,u=new Uint8Array(o+n);if(f){for(var s=0,l=0;l<o-1&&(255!=f[l]||217!=f[l+1]);l++)u[s++]=f[l];var v=e[t],c=e[t+1];255==v&&216==c||(u[s++]=v,u[s++]=c);for(l=2;l<n;l++)u[s++]=e[t+l]}else for(l=0;l<n;l++)u[l]=e[t+l];if(32803==r.t262[0]||7==r.t259[0]&&34892==r.t262[0]){var d=r.t258[0],h=UTIF.LosslessJpegDecode(u),U=h.length;if(16==d)if(r.isLE)for(l=0;l<U;l++)i[a+(l<<1)]=255&h[l],i[a+(l<<1)+1]=h[l]>>>8;else for(l=0;l<U;l++)i[a+(l<<1)]=h[l]>>>8,i[a+(l<<1)+1]=255&h[l];else if(14==d||12==d||10==d){var I=16-d;for(l=0;l<U;l++)UTIF.decode._putsF(i,l*d,h[l]<<I)}else{if(8!=d)throw new Error("unsupported bit depth "+d);for(l=0;l<U;l++)i[a+l]=h[l]}}else{var w=new UTIF.JpegDecoder;w.parse(u);var g=w.getData({width:w.width,height:w.height,forceRGB:!0,isSourcePDF:!1});for(l=0;l<g.length;l++)i[a+l]=g[l]}6==r.t262[0]&&(r.t262[0]=2)},UTIF.decode._decodeOldJPEGInit=function(r,e,t,n){var i,a,f,o,u,s=216,l=0,v=0,c=!1,d=r.t513,h=d?d[0]:0,U=r.t514,I=U?U[0]:0,w=r.t324||r.t273||d,g=r.t530,F=0,T=0,_=r.t277?r.t277[0]:1,b=r.t515;if(w&&(v=w[0],c=w.length>1),!c){if(255==e[t]&&e[t+1]==s)return{jpegOffset:t};if(null!=d&&(255==e[t+h]&&e[t+h+1]==s?l=t+h:log("JPEGInterchangeFormat does not point to SOI"),null==U?log("JPEGInterchangeFormatLength field is missing"):(h>=v||h+I<=v)&&log("JPEGInterchangeFormatLength field value is invalid"),null!=l))return{jpegOffset:l}}if(null!=g&&(F=g[0],T=g[1]),null!=d&&null!=U)if(I>=2&&h+I<=v){for(i=255==e[t+h+I-2]&&e[t+h+I-1]==s?new Uint8Array(I-2):new Uint8Array(I),f=0;f<i.length;f++)i[f]=e[t+h+f];log("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else log("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==i){var p=0,m=[];m[p++]=255,m[p++]=s;var A=r.t519;if(null==A)throw new Error("JPEGQTables tag is missing");for(f=0;f<A.length;f++)for(m[p++]=255,m[p++]=219,m[p++]=0,m[p++]=67,m[p++]=f,o=0;o<64;o++)m[p++]=e[t+A[f]+o];for(u=0;u<2;u++){var y=r[0==u?"t520":"t521"];if(null==y)throw new Error((0==u?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(f=0;f<y.length;f++){m[p++]=255,m[p++]=196;var E=19;for(o=0;o<16;o++)E+=e[t+y[f]+o];for(m[p++]=E>>>8,m[p++]=255&E,m[p++]=f|u<<4,o=0;o<16;o++)m[p++]=e[t+y[f]+o];for(o=0;o<E;o++)m[p++]=e[t+y[f]+16+o]}}if(m[p++]=255,m[p++]=192,m[p++]=0,m[p++]=8+3*_,m[p++]=8,m[p++]=r.height>>>8&255,m[p++]=255&r.height,m[p++]=r.width>>>8&255,m[p++]=255&r.width,m[p++]=_,1==_)m[p++]=1,m[p++]=17,m[p++]=0;else for(f=0;f<3;f++)m[p++]=f+1,m[p++]=0!=f?17:(15&F)<<4|15&T,m[p++]=f;null!=b&&0!=b[0]&&(m[p++]=255,m[p++]=221,m[p++]=0,m[p++]=4,m[p++]=b[0]>>>8&255,m[p++]=255&b[0]),i=new Uint8Array(m)}var D=-1;for(f=0;f<i.length-1;){if(255==i[f]&&192==i[f+1]){D=f;break}f++}if(-1==D){var M=new Uint8Array(i.length+10+3*_);M.set(i);var B=i.length;if(D=i.length,(i=M)[B++]=255,i[B++]=192,i[B++]=0,i[B++]=8+3*_,i[B++]=8,i[B++]=r.height>>>8&255,i[B++]=255&r.height,i[B++]=r.width>>>8&255,i[B++]=255&r.width,i[B++]=_,1==_)i[B++]=1,i[B++]=17,i[B++]=0;else for(f=0;f<3;f++)i[B++]=f+1,i[B++]=0!=f?17:(15&F)<<4|15&T,i[B++]=f}if(255==e[v]&&218==e[v+1]){var k=e[v+2]<<8|e[v+3];for((a=new Uint8Array(k+2))[0]=e[v],a[1]=e[v+1],a[2]=e[v+2],a[3]=e[v+3],f=0;f<k-2;f++)a[f+4]=e[v+f+4]}else{var P=0;if((a=new Uint8Array(8+2*_))[P++]=255,a[P++]=218,a[P++]=0,a[P++]=6+2*_,a[P++]=_,1==_)a[P++]=1,a[P++]=0;else for(f=0;f<3;f++)a[P++]=f+1,a[P++]=f<<4|f;a[P++]=0,a[P++]=63,a[P++]=0}return{jpegOffset:t,tables:i,sosMarker:a,sofPosition:D}},UTIF.decode._decodeOldJPEG=function(r,e,t,n,i,a){var f,o,u,s,l=UTIF.decode._decodeOldJPEGInit(r,e,t,n);if(null!=l.jpegOffset)for(f=t+n-l.jpegOffset,u=new Uint8Array(f),d=0;d<f;d++)u[d]=e[l.jpegOffset+d];else{for(o=l.tables.length,(u=new Uint8Array(o+l.sosMarker.length+n+2)).set(l.tables),s=o,u[l.sofPosition+5]=r.height>>>8&255,u[l.sofPosition+6]=255&r.height,u[l.sofPosition+7]=r.width>>>8&255,u[l.sofPosition+8]=255&r.width,255==e[t]&&e[t+1]==SOS||(u.set(l.sosMarker,s),s+=sosMarker.length),d=0;d<n;d++)u[s++]=e[t+d];u[s++]=255,u[s++]=EOI}var v=new UTIF.JpegDecoder;v.parse(u);for(var c=v.getData({width:v.width,height:v.height,forceRGB:!0,isSourcePDF:!1}),d=0;d<c.length;d++)i[a+d]=c[d];r.t262&&6==r.t262[0]&&(r.t262[0]=2)},UTIF.decode._decodePackBits=function(r,e,t,n,i){for(var a=new Int8Array(r.buffer),f=new Int8Array(n.buffer),o=e+t;e<o;){var u=a[e];if(e++,u>=0&&u<128)for(var s=0;s<u+1;s++)f[i]=a[e],i++,e++;if(u>=-127&&u<0){for(s=0;s<1-u;s++)f[i]=a[e],i++;e++}}return i},UTIF.decode._decodeThunder=function(r,e,t,n,i){for(var a=[0,1,0,-1],f=[0,1,2,3,0,-3,-2,-1],o=e+t,u=2*i,s=0;e<o;){var l=r[e],v=l>>>6,c=63&l;if(e++,3==v&&(s=15&c,n[u>>>1]|=s<<4*(1-u&1),u++),0==v)for(var d=0;d<c;d++)n[u>>>1]|=s<<4*(1-u&1),u++;if(2==v)for(d=0;d<2;d++){4!=(h=c>>>3*(1-d)&7)&&(s+=f[h],n[u>>>1]|=s<<4*(1-u&1),u++)}if(1==v)for(d=0;d<3;d++){var h;2!=(h=c>>>2*(2-d)&3)&&(s+=a[h],n[u>>>1]|=s<<4*(1-u&1),u++)}}},UTIF.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},UTIF.decode._lens=function(){var r=function(r,e,t,n){for(var i=0;i<e.length;i++)r[e[i]]=t+i*n},e="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",t="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",n="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",i="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",a="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";e=e.split(","),t=t.split(","),n=n.split(","),i=i.split(","),a=a.split(",");var f={},o={};return r(f,e,0,1),r(f,n,64,64),r(f,a,1792,64),r(o,t,0,1),r(o,i,64,64),r(o,a,1792,64),[f,o]}(),UTIF.decode._decodeG4=function(r,e,t,n,i,a,f){for(var o=UTIF.decode,u=e<<3,s=0,l="",v=[],c=[],d=0;d<a;d++)c.push(0);c=o._makeDiff(c);for(var h=0,U=0,I=0,w=0,g=0,F=0,T="",_=0,b=8*Math.ceil(a/8);u>>>3<e+t;){I=o._findDiff(c,h+(0==h?0:1),1-g),w=o._findDiff(c,I,g);var p=0;if(1==f&&(p=r[u>>>3]>>>7-(7&u)&1),2==f&&(p=r[u>>>3]>>>(7&u)&1),u++,l+=p,"H"==T){if(null!=o._lens[g][l]){var m=o._lens[g][l];l="",s+=m,m<64&&(o._addNtimes(v,s,g),h+=s,g=1-g,s=0,0==--_&&(T=""))}}else"0001"==l&&(l="",o._addNtimes(v,w-h,g),h=w),"001"==l&&(l="",T="H",_=2),null!=o._dmap[l]&&(U=I+o._dmap[l],o._addNtimes(v,U-h,g),h=U,l="",g=1-g);v.length==a&&""==T&&(o._writeBits(v,n,8*i+F*b),g=0,F++,h=0,c=o._makeDiff(v),v=[])}},UTIF.decode._findDiff=function(r,e,t){for(var n=0;n<r.length;n+=2)if(r[n]>=e&&r[n+1]==t)return r[n]},UTIF.decode._makeDiff=function(r){var e=[];1==r[0]&&e.push(0,1);for(var t=1;t<r.length;t++)r[t-1]!=r[t]&&e.push(t,r[t]);return e.push(r.length,0,r.length,1),e},UTIF.decode._decodeG2=function(r,e,t,n,i,a,f){for(var o=UTIF.decode,u=e<<3,s=0,l="",v=[],c=0,d=0,h=8*Math.ceil(a/8);u>>>3<e+t;){var U=0;1==f&&(U=r[u>>>3]>>>7-(7&u)&1),2==f&&(U=r[u>>>3]>>>(7&u)&1),u++,l+=U,null!=(s=o._lens[c][l])&&(o._addNtimes(v,s,c),l="",s<64&&(c=1-c),v.length==a&&(o._writeBits(v,n,8*i+d*h),v=[],d++,c=0,0!=(7&u)&&(u+=8-(7&u)),s>=64&&(u+=8)))}},UTIF.decode._decodeG3=function(r,e,t,n,i,a,f,o){for(var u=UTIF.decode,s=e<<3,l=0,v="",c=[],d=[],h=0;h<a;h++)c.push(0);for(var U=0,I=0,w=0,g=0,F=0,T=-1,_="",b=0,p=!0,m=8*Math.ceil(a/8);s>>>3<e+t;){w=u._findDiff(d,U+(0==U?0:1),1-F),g=u._findDiff(d,w,F);var A=0;if(1==f&&(A=r[s>>>3]>>>7-(7&s)&1),2==f&&(A=r[s>>>3]>>>(7&s)&1),s++,v+=A,p){if(null!=u._lens[F][v]){var y=u._lens[F][v];v="",l+=y,y<64&&(u._addNtimes(c,l,F),F=1-F,l=0)}}else if("H"==_){if(null!=u._lens[F][v]){y=u._lens[F][v];v="",l+=y,y<64&&(u._addNtimes(c,l,F),U+=l,F=1-F,l=0,0==--b&&(_=""))}}else"0001"==v&&(v="",u._addNtimes(c,g-U,F),U=g),"001"==v&&(v="",_="H",b=2),null!=u._dmap[v]&&(I=w+u._dmap[v],u._addNtimes(c,I-U,F),U=I,v="",F=1-F);v.endsWith("000000000001")&&(T>=0&&u._writeBits(c,n,8*i+T*m),o&&(1==f&&(p=1==(r[s>>>3]>>>7-(7&s)&1)),2==f&&(p=1==(r[s>>>3]>>>(7&s)&1)),s++),v="",F=0,T++,U=0,d=u._makeDiff(c),c=[])}c.length==a&&u._writeBits(c,n,8*i+T*m)},UTIF.decode._addNtimes=function(r,e,t){for(var n=0;n<e;n++)r.push(t)},UTIF.decode._writeBits=function(r,e,t){for(var n=0;n<r.length;n++)e[t+n>>>3]|=r[n]<<7-(t+n&7)},UTIF.decode._decodeLZW=UTIF.decode._decodeLZW=function(){var r,e,t,n,i=0,a=0,f=0,o=0,u=function(){var t=r>>>3,n=(e[t]<<16|e[t+1]<<8|e[t+2])>>>24-(7&r)-a&(1<<a)-1;return r+=a,n},s=new Uint32Array(16384),l=0,v=function(r){a=r+1,i=o+1},c=function(r){for(var e=r<<2,i=s[e+2],a=n+i-1;65535!=e;)t[a--]=s[e],e=s[e+1];n+=i},d=function(r,e){var t=i<<2,n=r<<2;s[t]=s[3+(e<<2)],s[t+1]=n,s[t+2]=s[n+2]+1,s[t+3]=s[n+3],++i+1==1<<a&&12!=a&&a++};return function(a,h,U,I,w,g){r=h<<3,e=a,t=I,n=w;var F=h+U<<3,T=0,_=0;for(!function(r){if(r!=l){l=r,o=1+(f=1<<r);for(var e=0;e<o+1;e++)s[4*e]=s[4*e+3]=e,s[4*e+1]=65535,s[4*e+2]=1}}(g),v(g);r<F&&(T=u())!=o;){if(T==f){if(v(g),(T=u())==o)break;c(T)}else T<i?(c(T),d(_,T)):(d(_,_),c(i-1));_=T}return n}}(),UTIF.tags={},UTIF._types=function(){var r=new Array(250);r.fill(0);return{basic:{main:r=r.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),UTIF._readIFD=function(r,e,t,n,i,a){var f=r.readUshort(e,t);t+=2;var o={};a.debug&&log("   ".repeat(i),n.length-1,">>>----------------");for(var u=0;u<f;u++){var s=r.readUshort(e,t);t+=2;var l=r.readUshort(e,t);t+=2;var v=r.readUint(e,t);t+=4;var c=r.readUint(e,t);t+=4;var d=[];if(1==l||7==l){var h=v<5?t-4:c;h+v>e.buffer.byteLength&&(v=e.buffer.byteLength-h),d=new Uint8Array(e.buffer,h,v)}if(2==l){var U=v<5?t-4:c,I=e[U],w=Math.max(0,Math.min(v-1,e.length-U));I<128||0==w?d.push(r.readASCII(e,U,w)):d=new Uint8Array(e.buffer,U,w)}if(3==l)for(var g=0;g<v;g++)d.push(r.readUshort(e,(v<3?t-4:c)+2*g));if(4==l||13==l)for(g=0;g<v;g++)d.push(r.readUint(e,(v<2?t-4:c)+4*g));if(5==l||10==l){var F=5==l?r.readUint:r.readInt;for(g=0;g<v;g++)d.push([F(e,c+8*g),F(e,c+8*g+4)])}if(8==l)for(g=0;g<v;g++)d.push(r.readShort(e,(v<3?t-4:c)+2*g));if(9==l)for(g=0;g<v;g++)d.push(r.readInt(e,(v<2?t-4:c)+4*g));if(11==l)for(g=0;g<v;g++)d.push(r.readFloat(e,c+4*g));if(12==l)for(g=0;g<v;g++)d.push(r.readDouble(e,c+8*g));if(0==v||0!=d.length){if(a.debug&&log("   ".repeat(i),s,l,UTIF.tags[s],d),o["t"+s]=d,330==s&&o.t272&&"DSLR-A100"==o.t272[0]);else if(330==s||34665==s||34853==s||50740==s&&r.readUshort(e,r.readUint(d,0))<300||61440==s){var T=50740==s?[r.readUint(d,0)]:d,_=[];for(g=0;g<T.length;g++)UTIF._readIFD(r,e,T[g],_,i+1,a);330==s&&(o.subIFD=_),34665==s&&(o.exifIFD=_[0]),34853==s&&(o.gpsiIFD=_[0]),50740==s&&(o.dngPrvt=_[0]),61440==s&&(o.fujiIFD=_[0])}if(37500==s&&a.parseMN){var b=d;if("Nikon"==r.readASCII(b,0,5))o.makerNote=UTIF.decode(b.slice(10).buffer)[0];else if("OLYMP"==r.readASCII(b,0,5)||"OM SYSTEM"==r.readASCII(b,0,9)){var p=[8208,8224,8240,8256,8272],m=[];UTIF._readIFD(r,b,77==b[1]?16:85==b[5]?12:8,m,i+1,a);var A=o.makerNote=m.pop();for(g=0;g<p.length;g++){var y="t"+p[g];null!=A[y]&&(UTIF._readIFD(r,b,A[y][0],m,i+1,a),A[y]=m.pop())}A.t12288&&(UTIF._readIFD(r,A.t12288,0,m,i+1,a),A.t12288=m.pop())}else if(r.readUshort(e,c)<300&&r.readUshort(e,c+4)<=12){m=[];UTIF._readIFD(r,e,c,m,i+1,a),o.makerNote=m[0]}}}else if(log(s,"unknown TIFF tag type: ",l,"num:",v),0==u)return}return n.push(o),a.debug&&log("   ".repeat(i),"<<<---------------"),t},UTIF._writeIFD=function(r,e,t,n,i){var a=Object.keys(i),f=a.length;i.exifIFD&&f--,i.gpsiIFD&&f--,r.writeUshort(t,n,f);for(var o=(n+=2)+12*f+4,u=0;u<a.length;u++){var s=a[u];if("t34665"!=s&&"t34853"!=s){"exifIFD"==s&&(s="t34665"),"gpsiIFD"==s&&(s="t34853");var l=parseInt(s.slice(1)),v=e.main[l];if(null==v&&(v=e.rest[l]),null==v||0==v)throw new Error("unknown type of tag: "+l);var c=i[s];if(34665==l)c=[o],o=UTIF._writeIFD(r,e,t,o,i.exifIFD)[1];if(34853==l)c=[o],o=UTIF._writeIFD(r,UTIF._types.gps,t,o,i.gpsiIFD)[1];2==v&&(c=c[0]+"\0");var d=c.length;r.writeUshort(t,n,l),n+=2,r.writeUshort(t,n,v),n+=2,r.writeUint(t,n,d);var h=[-1,1,1,2,4,8,0,1,0,4,8,0,8][v]*d,U=n+=4;if(h>4&&(r.writeUint(t,n,o),U=o),1==v||7==v)for(var I=0;I<d;I++)t[U+I]=c[I];else if(2==v)r.writeASCII(t,U,c);else if(3==v)for(I=0;I<d;I++)r.writeUshort(t,U+2*I,c[I]);else if(4==v)for(I=0;I<d;I++)r.writeUint(t,U+4*I,c[I]);else if(5==v||10==v){var w=5==v?r.writeUint:r.writeInt;for(I=0;I<d;I++){var g=c[I],F=g[0],T=g[1];if(null==F)throw"e";w(t,U+8*I,F),w(t,U+8*I+4,T)}}else if(9==v)for(I=0;I<d;I++)r.writeInt(t,U+4*I,c[I]);else{if(12!=v)throw v;for(I=0;I<d;I++)r.writeDouble(t,U+8*I,c[I])}h>4&&(o+=h+=1&h),n+=4}}return[n,o]},UTIF.toRGBA8=function(r,e){function t(r){return r<.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055}var n=r.width,i=r.height,a=n*i,f=r.data,o=new Uint8Array(4*a),u=r.t262?r.t262[0]:2,s=r.t258?Math.min(32,r.t258[0]):1;null==r.t262&&1==s&&(u=0);var l=r.t277?r.t277[0]:r.t258?r.t258.length:[1,1,3,1,1,4,3][u],v=r.t339?r.t339[0]:null;if(1==u&&32==s&&3!=v)throw"e";var c=Math.ceil(l*s*n/8);if(0==u){e=1/256;for(var d=0;d<i;d++){var h=d*c,U=d*n;if(1==s)for(var I=0;I<n;I++){var w=U+I<<2,g=f[h+(I>>3)]>>7-(7&I)&1;o[w]=o[w+1]=o[w+2]=255*(1-g),o[w+3]=255}if(4==s)for(I=0;I<n;I++){w=U+I<<2,g=f[h+(I>>1)]>>4-4*(1&I)&15;o[w]=o[w+1]=o[w+2]=17*(15-g),o[w+3]=255}if(8==s)for(I=0;I<n;I++){w=U+I<<2,g=f[h+I];o[w]=o[w+1]=o[w+2]=255-g,o[w+3]=255}if(16==s)for(I=0;I<n;I++){w=U+I<<2,g=f[(T=h+2*I)+1]<<8|f[T];o[w]=o[w+1]=o[w+2]=Math.min(255,255-~~(g*e)),o[w+3]=255}}}else if(1==u){null==e&&(e=1/256);var F=0==(3&f.length)?new Float32Array(f.buffer):null;for(d=0;d<i;d++){h=d*c,U=d*n;if(1==s)for(I=0;I<n;I++){w=U+I<<2,g=f[h+(I>>3)]>>7-(7&I)&1;o[w]=o[w+1]=o[w+2]=255*g,o[w+3]=255}if(2==s)for(I=0;I<n;I++){w=U+I<<2,g=f[h+(I>>2)]>>6-2*(3&I)&3;o[w]=o[w+1]=o[w+2]=85*g,o[w+3]=255}if(8==s)for(I=0;I<n;I++){w=U+I<<2,g=f[h+I*l];o[w]=o[w+1]=o[w+2]=g,o[w+3]=255}if(16==s)for(I=0;I<n;I++){w=U+I<<2,g=f[(T=h+2*I)+1]<<8|f[T];o[w]=o[w+1]=o[w+2]=Math.min(255,~~(g*e)),o[w+3]=255}if(32==s)for(I=0;I<n;I++){var T;w=U+I<<2,g=F[T=(h>>>2)+I];o[w]=o[w+1]=o[w+2]=~~(.5+255*g),o[w+3]=255}}}else if(2==u)if(8==s){if(1==l)for(I=0;I<a;I++)o[4*I]=o[4*I+1]=o[4*I+2]=f[I],o[4*I+3]=255;if(3==l)for(I=0;I<a;I++){var _=3*I;o[w=I<<2]=f[_],o[w+1]=f[_+1],o[w+2]=f[_+2],o[w+3]=255}if(l>=4)for(I=0;I<a;I++){_=I*l;o[w=I<<2]=f[_],o[w+1]=f[_+1],o[w+2]=f[_+2],o[w+3]=f[_+3]}}else if(16==s){if(4==l)for(I=0;I<a;I++){_=8*I+1;o[w=I<<2]=f[_],o[w+1]=f[_+2],o[w+2]=f[_+4],o[w+3]=f[_+6]}if(3==l)for(I=0;I<a;I++){_=6*I+1;o[w=I<<2]=f[_],o[w+1]=f[_+2],o[w+2]=f[_+4],o[w+3]=255}}else{if(32!=s)throw s;var b=new Float32Array(f.buffer),p=0;for(I=0;I<b.length;I++)p=Math.min(p,b[I]);if(p<0)for(I=0;I<f.length;I+=4){var m=f[I];f[I]=f[I+3],f[I+3]=m,m=f[I+1],f[I+1]=f[I+2],f[I+2]=m}var A=[];for(I=0;I<65536;I++)A.push(t(I/65535));for(I=0;I<b.length;I++){var y=Math.max(0,Math.min(1,b[I]));b[I]=A[~~(.5+65535*y)]}if(3==l)for(I=0;I<a;I++){_=3*I;o[w=I<<2]=~~(.5+255*b[_]),o[w+1]=~~(.5+255*b[_+1]),o[w+2]=~~(.5+255*b[_+2]),o[w+3]=255}else{if(4!=l)throw l;for(I=0;I<a;I++){_=4*I;o[w=I<<2]=~~(.5+255*b[_]),o[w+1]=~~(.5+255*b[_+1]),o[w+2]=~~(.5+255*b[_+2]),o[w+3]=~~(.5+255*b[_+3])}}}else if(3==u){var E=r.t320,D=1<<s,M=8==s&&l>1&&r.t338&&0!=r.t338[0];for(d=0;d<i;d++)for(var B=0;B<n;B++){w=(I=d*n+B)<<2;var k=0,P=d*c;if(1==s)k=f[P+(B>>>3)]>>>7-(7&B)&1;else if(2==s)k=f[P+(B>>>2)]>>>6-2*(3&B)&3;else if(4==s)k=f[P+(B>>>1)]>>>4-4*(1&B)&15;else{if(8!=s)throw s;k=f[P+B*l]}o[w]=E[k]>>8,o[w+1]=E[D+k]>>8,o[w+2]=E[D+D+k]>>8,o[w+3]=M?f[P+B*l+1]:255}}else if(5==u){var x=l>4?1:0;for(I=0;I<a;I++){w=I<<2;var C=I*l;if(window.UDOC){var H=f[C],L=f[C+1],S=f[C+2],G=f[C+3],J=UDOC.C.cmykToRgb([H*(1/255),L*(1/255),S*(1/255),G*(1/255)]);o[w]=~~(.5+255*J[0]),o[w+1]=~~(.5+255*J[1]),o[w+2]=~~(.5+255*J[2])}else{H=255-f[C],L=255-f[C+1],S=255-f[C+2],G=(255-f[C+3])*(1/255);o[w]=~~(H*G+.5),o[w+1]=~~(L*G+.5),o[w+2]=~~(S*G+.5)}o[w+3]=255*(1-x)+f[C+4]*x}}else if(6==u&&r.t278){var N=r.t278[0];for(d=0;d<i;d+=N){I=d*n;for(var O=N*n,W=0;W<O;W++){w=4*(I+W),S=f[(C=3*I+4*(W>>>1))+(1&W)];var j=f[C+2]-128,R=f[C+3]-128,Q=S+((R>>2)+(R>>3)+(R>>5)),q=S-((j>>2)+(j>>4)+(j>>5))-((R>>1)+(R>>3)+(R>>4)+(R>>5)),Z=S+(j+(j>>1)+(j>>2)+(j>>6));o[w]=Math.max(0,Math.min(255,Q)),o[w+1]=Math.max(0,Math.min(255,q)),o[w+2]=Math.max(0,Math.min(255,Z)),o[w+3]=255}}}else if(32845==u)for(d=0;d<i;d++)for(B=0;B<n;B++){w=4*(d*n+B);var $=f[(C=6*(d*n+B))+1]<<8|f[C],V=($=Math.pow(2,($+.5)/256-64),(f[C+3]+.5)/410),X=(f[C+5]+.5)/410,z=9*V/(6*V-16*X+12),Y=4*X/(6*V-16*X+12),K=z*$/Y,rr=(1-z-Y)*$/Y;Q=2.69*K-1.276*(S=$)-.414*rr,q=-1.022*K+1.978*S+.044*rr,Z=.061*K-.224*S+1.163*rr;o[w]=255*t(Math.min(Q,1)),o[w+1]=255*t(Math.min(q,1)),o[w+2]=255*t(Math.min(Z,1)),o[w+3]=255}else log("Unknown Photometric interpretation: "+u);return o},UTIF.replaceIMG=function(r){null==r&&(r=document.getElementsByTagName("img"));for(var e=["tif","tiff","dng","cr2","nef"],t=0;t<r.length;t++){var n=r[t],i=n.getAttribute("src");if(null!=i){var a=i.split(".").pop().toLowerCase();if(-1!=e.indexOf(a)){var f=new XMLHttpRequest;UTIF._xhrs.push(f),UTIF._imgs.push(n),f.open("GET",i),f.responseType="arraybuffer",f.onload=UTIF._imgLoaded,f.send()}}}},UTIF._xhrs=[],UTIF._imgs=[],UTIF._imgLoaded=function(r){var e=UTIF._xhrs.indexOf(r.target),t=UTIF._imgs[e];UTIF._xhrs.splice(e,1),UTIF._imgs.splice(e,1),t.setAttribute("src",UTIF.bufferToURI(r.target.response))},UTIF.bufferToURI=function(r){var e=UTIF.decode(r),t=e,n=0,i=t[0];e[0].subIFD&&(t=t.concat(e[0].subIFD));for(var a=0;a<t.length;a++){var f=t[a];if(!(null==f.t258||f.t258.length<3)){var o=f.t256*f.t257;o>n&&(n=o,i=f)}}UTIF.decodeImage(r,i,e);var u=UTIF.toRGBA8(i),s=i.width,l=i.height,v=document.createElement("canvas");v.width=s,v.height=l;var c=v.getContext("2d"),d=new ImageData(new Uint8ClampedArray(u.buffer),s,l);return c.putImageData(d,0,0),v.toDataURL()},UTIF._binBE={nextZero:function(r,e){for(;0!=r[e];)e++;return e},readUshort:function(r,e){return r[e]<<8|r[e+1]},readShort:function(r,e){var t=UTIF._binBE.ui8;return t[0]=r[e+1],t[1]=r[e+0],UTIF._binBE.i16[0]},readInt:function(r,e){var t=UTIF._binBE.ui8;return t[0]=r[e+3],t[1]=r[e+2],t[2]=r[e+1],t[3]=r[e+0],UTIF._binBE.i32[0]},readUint:function(r,e){var t=UTIF._binBE.ui8;return t[0]=r[e+3],t[1]=r[e+2],t[2]=r[e+1],t[3]=r[e+0],UTIF._binBE.ui32[0]},readASCII:function(r,e,t){for(var n="",i=0;i<t;i++)n+=String.fromCharCode(r[e+i]);return n},readFloat:function(r,e){for(var t=UTIF._binBE.ui8,n=0;n<4;n++)t[n]=r[e+3-n];return UTIF._binBE.fl32[0]},readDouble:function(r,e){for(var t=UTIF._binBE.ui8,n=0;n<8;n++)t[n]=r[e+7-n];return UTIF._binBE.fl64[0]},writeUshort:function(r,e,t){r[e]=t>>8&255,r[e+1]=255&t},writeInt:function(r,e,t){var n=UTIF._binBE.ui8;UTIF._binBE.i32[0]=t,r[e+3]=n[0],r[e+2]=n[1],r[e+1]=n[2],r[e+0]=n[3]},writeUint:function(r,e,t){r[e]=t>>24&255,r[e+1]=t>>16&255,r[e+2]=t>>8&255,r[e+3]=t>>0&255},writeASCII:function(r,e,t){for(var n=0;n<t.length;n++)r[e+n]=t.charCodeAt(n)},writeDouble:function(r,e,t){UTIF._binBE.fl64[0]=t;for(var n=0;n<8;n++)r[e+n]=UTIF._binBE.ui8[7-n]}},UTIF._binBE.ui8=new Uint8Array(8),UTIF._binBE.i16=new Int16Array(UTIF._binBE.ui8.buffer),UTIF._binBE.i32=new Int32Array(UTIF._binBE.ui8.buffer),UTIF._binBE.ui32=new Uint32Array(UTIF._binBE.ui8.buffer),UTIF._binBE.fl32=new Float32Array(UTIF._binBE.ui8.buffer),UTIF._binBE.fl64=new Float64Array(UTIF._binBE.ui8.buffer),UTIF._binLE={nextZero:UTIF._binBE.nextZero,readUshort:function(r,e){return r[e+1]<<8|r[e]},readShort:function(r,e){var t=UTIF._binBE.ui8;return t[0]=r[e+0],t[1]=r[e+1],UTIF._binBE.i16[0]},readInt:function(r,e){var t=UTIF._binBE.ui8;return t[0]=r[e+0],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],UTIF._binBE.i32[0]},readUint:function(r,e){var t=UTIF._binBE.ui8;return t[0]=r[e+0],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],UTIF._binBE.ui32[0]},readASCII:UTIF._binBE.readASCII,readFloat:function(r,e){for(var t=UTIF._binBE.ui8,n=0;n<4;n++)t[n]=r[e+n];return UTIF._binBE.fl32[0]},readDouble:function(r,e){for(var t=UTIF._binBE.ui8,n=0;n<8;n++)t[n]=r[e+n];return UTIF._binBE.fl64[0]},writeUshort:function(r,e,t){r[e]=255&t,r[e+1]=t>>8&255},writeInt:function(r,e,t){var n=UTIF._binBE.ui8;UTIF._binBE.i32[0]=t,r[e+0]=n[0],r[e+1]=n[1],r[e+2]=n[2],r[e+3]=n[3]},writeUint:function(r,e,t){r[e]=t>>>0&255,r[e+1]=t>>>8&255,r[e+2]=t>>>16&255,r[e+3]=t>>>24&255},writeASCII:UTIF._binBE.writeASCII},UTIF._copyTile=function(r,e,t,n,i,a,f,o){for(var u=Math.min(e,i-f),s=Math.min(t,a-o),l=0;l<s;l++)for(var v=(o+l)*i+f,c=l*e,d=0;d<u;d++)n[v+d]=r[c+d]},UTIF._inflateRaw=function(){var r,e,t={};return t.H={},t.H.N=function(r,e){var n,i,a=Uint8Array,f=0,o=0,u=0,s=0,l=0,v=0,c=0,d=0,h=0;if(3==r[0]&&0==r[1])return e||new a(0);var U=t.H,I=U.b,w=U.e,g=U.R,F=U.n,T=U.A,_=U.Z,b=U.m,p=null==e;for(p&&(e=new a(r.length>>>2<<5));0==f;)if(f=I(r,h,1),o=I(r,h+1,2),h+=3,0!=o){if(p&&(e=t.H.W(e,d+(1<<17))),1==o&&(n=b.J,i=b.h,v=511,c=31),2==o){u=w(r,h,5)+257,s=w(r,h+5,5)+1,l=w(r,h+10,4)+4;h+=14;for(var m=1,A=0;A<38;A+=2)b.Q[A]=0,b.Q[A+1]=0;for(A=0;A<l;A++){var y=w(r,h+3*A,3);b.Q[1+(b.X[A]<<1)]=y,y>m&&(m=y)}h+=3*l,F(b.Q,m),T(b.Q,m,b.u),n=b.w,i=b.d,h=g(b.u,(1<<m)-1,u+s,r,h,b.v);var E=U.V(b.v,0,u,b.C);v=(1<<E)-1;var D=U.V(b.v,u,s,b.D);c=(1<<D)-1,F(b.C,E),T(b.C,E,n),F(b.D,D),T(b.D,D,i)}for(;;){var M=n[_(r,h)&v];h+=15&M;var B=M>>>4;if(B>>>8==0)e[d++]=B;else{if(256==B)break;var k=d+B-254;if(B>264){var P=b.q[B-257];k=d+(P>>>3)+w(r,h,7&P),h+=7&P}var x=i[_(r,h)&c];h+=15&x;var C=x>>>4,H=b.c[C],L=(H>>>4)+I(r,h,15&H);for(h+=15&H;d<k;)e[d]=e[d++-L],e[d]=e[d++-L],e[d]=e[d++-L],e[d]=e[d++-L];d=k}}}else{0!=(7&h)&&(h+=8-(7&h));var S=4+(h>>>3),G=r[S-4]|r[S-3]<<8;p&&(e=t.H.W(e,d+G)),e.set(new a(r.buffer,r.byteOffset+S,G),d),h=S+G<<3,d+=G}return e.length==d?e:e.slice(0,d)},t.H.W=function(r,e){var t=r.length;if(e<=t)return r;var n=new Uint8Array(t<<1);return n.set(r,0),n},t.H.R=function(r,e,n,i,a,f){for(var o=t.H.e,u=t.H.Z,s=0;s<n;){var l=r[u(i,a)&e];a+=15&l;var v=l>>>4;if(v<=15)f[s]=v,s++;else{var c=0,d=0;16==v?(d=3+o(i,a,2),a+=2,c=f[s-1]):17==v?(d=3+o(i,a,3),a+=3):18==v&&(d=11+o(i,a,7),a+=7);for(var h=s+d;s<h;)f[s]=c,s++}}return a},t.H.V=function(r,e,t,n){for(var i=0,a=0,f=n.length>>>1;a<t;){var o=r[a+e];n[a<<1]=0,n[1+(a<<1)]=o,o>i&&(i=o),a++}for(;a<f;)n[a<<1]=0,n[1+(a<<1)]=0,a++;return i},t.H.n=function(r,e){for(var n,i,a,f,o=t.H.m,u=r.length,s=o.j,l=0;l<=e;l++)s[l]=0;for(l=1;l<u;l+=2)s[r[l]]++;var v=o.K;for(n=0,s[0]=0,i=1;i<=e;i++)n=n+s[i-1]<<1,v[i]=n;for(a=0;a<u;a+=2)0!=(f=r[a+1])&&(r[a]=v[f],v[f]++)},t.H.A=function(r,e,n){for(var i=r.length,a=t.H.m.r,f=0;f<i;f+=2)if(0!=r[f+1])for(var o=f>>1,u=r[f+1],s=o<<4|u,l=e-u,v=r[f]<<l,c=v+(1<<l);v!=c;){n[a[v]>>>15-e]=s,v++}},t.H.l=function(r,e){for(var n=t.H.m.r,i=15-e,a=0;a<r.length;a+=2){var f=r[a]<<e-r[a+1];r[a]=n[f]>>>i}},t.H.M=function(r,e,t){t<<=7&e;var n=e>>>3;r[n]|=t,r[n+1]|=t>>>8},t.H.I=function(r,e,t){t<<=7&e;var n=e>>>3;r[n]|=t,r[n+1]|=t>>>8,r[n+2]|=t>>>16},t.H.e=function(r,e,t){return(r[e>>>3]|r[1+(e>>>3)]<<8)>>>(7&e)&(1<<t)-1},t.H.b=function(r,e,t){return(r[e>>>3]|r[1+(e>>>3)]<<8|r[2+(e>>>3)]<<16)>>>(7&e)&(1<<t)-1},t.H.Z=function(r,e){return(r[e>>>3]|r[1+(e>>>3)]<<8|r[2+(e>>>3)]<<16)>>>(7&e)},t.H.i=function(r,e){return(r[e>>>3]|r[1+(e>>>3)]<<8|r[2+(e>>>3)]<<16|r[3+(e>>>3)]<<24)>>>(7&e)},t.H.m=(r=Uint16Array,e=Uint32Array,{K:new r(16),j:new r(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new r(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new e(32),J:new r(512),_:[],h:new r(32),$:[],w:new r(32768),C:[],v:[],d:new r(32768),D:[],u:new r(512),Q:[],r:new r(32768),s:new e(286),Y:new e(30),a:new e(19),t:new e(15e3),k:new r(65536),g:new r(32768)}),function(){for(var r=t.H.m,e=0;e<32768;e++){var n=e;n=(4278255360&(n=(4042322160&(n=(3435973836&(n=(2863311530&n)>>>1|(1431655765&n)<<1))>>>2|(858993459&n)<<2))>>>4|(252645135&n)<<4))>>>8|(16711935&n)<<8,r.r[e]=(n>>>16|n<<16)>>>17}function i(r,e,t){for(;0!=e--;)r.push(0,t)}for(e=0;e<32;e++)r.q[e]=r.S[e]<<3|r.T[e],r.c[e]=r.p[e]<<4|r.z[e];i(r._,144,8),i(r._,112,9),i(r._,24,7),i(r._,8,8),t.H.n(r._,9),t.H.A(r._,9,r.J),t.H.l(r._,9),i(r.$,32,5),t.H.n(r.$,5),t.H.A(r.$,5,r.h),t.H.l(r.$,5),i(r.Q,19,0),i(r.C,286,0),i(r.D,30,0),i(r.v,320,0)}(),t.H.N}(),UTIF.LosslessJpegDecode=function(){var r,e;function t(){return r[e++]}function n(){return r[e++]<<8|r[e++]}function i(r){for(var e=t(),n=[0,0,0,255],i=[],f=0;f<16;f++)i[f]=t();for(f=0;f<16;f++)for(var o=0;o<i[f];o++){n[a(n,0,f+1,1)+3]=t()}var u=new Uint8Array(256);r[e]=[new Uint8Array(n),u];for(f=0;f<256;f++){for(var s=8,l=f,v=0;255==n[v+3]&&0!=s;)v=n[v+(l>>--s&1)];u[f]=v}}function a(r,e,t,n){if(255!=r[e+3])return 0;if(0==t)return e;for(var i=0;i<2;i++){0==r[e+i]&&(r[e+i]=r.length,r.push(0,0,n,255));var f=a(r,r[e+i],t-1,n+1);if(0!=f)return f}return 0}function f(r){for(var e=r.b,t=r.f;e<25&&r.a<r.d;){var n=r.data[r.a++];255!=n||r.c||r.a++,t=t<<8|n,e+=8}if(e<0)throw"e";r.b=e,r.f=t}function o(r,e){return e.b<r&&f(e),e.f>>(e.b-=r)&65535>>16-r}function u(r,e){var t=r[0],n=0,i=255;e.b<16&&f(e);var a=e.f>>e.b-8&255;for(i=t[(n=r[1][a])+3],e.b-=t[n+2];255==i;)i=t[(n=t[n+(e.f>>--e.b&1)])+3];return i}function s(r,e){return r<32768>>16-e&&(r+=1-(1<<e)),r}function l(r,e){var t=u(r,e);return 0==t?0:16==t?-32768:s(o(t,e),t)}function v(r,e,t,n,i,a){for(var f=0,o=0;o<a;o++){for(var u=o*e,s=0;s<e;s+=i){f++;for(var v=0;v<i;v++)r[u+s+v]=l(n[v],t)}if(0!=t.e&&f%t.e==0&&0!=o){for(var c=t.a,d=t.data;255!=d[c]||!(208<=d[c+1]&&d[c+1]<=215);)c--;t.a=c+2,t.f=0,t.b=0}}}function c(r,e){return s(o(r,e),r)}function d(r,e,t,n,i,a,f,o){for(var u=t*f,s=i;s<a;s++)r[s]+=1<<o-1;for(var l=f;l<u;l+=f)for(s=i;s<a;s++)r[l+s]+=r[l+s-f];for(var v=1;v<n;v++){var c=v*u;for(s=i;s<a;s++)r[c+s]+=r[c+s-u];for(l=f;l<u;l+=f)for(s=i;s<a;s++){var d=c+l+s,h=d-u,U=r[d-f],I=0;if(0==e)I=0;else if(1==e)I=U;else if(2==e)I=r[h];else if(3==e)I=r[h-f];else if(4==e)I=U+(r[h]-r[h-f]);else if(5==e)I=U+(r[h]-r[h-f]>>>1);else if(6==e)I=r[h]+(U-r[h-f]>>>1);else{if(7!=e)throw e;I=U+r[h]>>>1}r[d]+=I}}}return function(a){if(r=a,e=0,65496!=n())throw"e";for(var f=[],o=0,s=0,l=0,h=[],U=[],I=[],w=0,g=0,F=0;;){var T=n();if(65535!=T){var _=n();if(65475==T){s=t(),g=n(),F=n(),w=t();for(var b=0;b<w;b++){var p=t(),m=t();if(0!=t())throw"e";f[p]=[b,m>>4,15&m]}}else if(65476==T)for(var A=e+_-2;e<A;)i(U);else{if(65498==T){e++;for(b=0;b<w;b++){var y=f[t()];I[y[0]]=U[t()>>>4],h[y[0]]=y.slice(1)}o=t(),e+=2;break}65501==T?l=n():e+=_-2}}else e--}var E=new(s>8?Uint16Array:Uint8Array)(g*F*w),D={b:0,f:0,c:8==o,a:e,data:r,d:r.length,e:l};if(D.c)!function(t,n,i,a,f){for(var o=r.length-e,s=0;s<o;s+=4){var l=r[e+s];r[e+s]=r[e+s+3],r[e+s+3]=l,l=r[e+s+1],r[e+s+1]=r[e+s+2],r[e+s+2]=l}for(var v=0;v<f;v++)for(var d=32768,h=32768,U=0;U<n;U+=2){var I=u(a,i),w=u(a,i);0!=I&&(d+=c(I,i)),0!=w&&(h+=c(w,i)),t[v*n+U]=65535&d,t[v*n+U+1]=65535&h}}(E,F*w,D,I[0],g);else{var M=[],B=0,k=0;for(b=0;b<w;b++){var P=h[b];(W=P[0])>B&&(B=W),(O=P[1])>k&&(k=O),M.push(W*O)}if(1!=B||1!=k){if(3!=w||1!=M[1]||1!=M[2])throw"e";if(2!=B||1!=k&&2!=k)throw"e";var x=[],C=0;for(b=0;b<w;b++){for(var H=0;H<M[b];H++)x.push(I[b]);C+=M[b]}var L=F/B,S=g/k,G=L*S;v(E,L*C,D,x,C,S),d(E,o,L,S,C-2,C,C,s);var J=new Uint16Array(G*M[0]);if(2==B&&2==k){for(b=0;b<G;b++)J[4*b]=E[6*b],J[4*b+1]=E[6*b+1],J[4*b+2]=E[6*b+2],J[4*b+3]=E[6*b+3];d(J,o,4*L,S,0,1,1,s);for(b=0;b<G;b++)E[6*b]=J[4*b],E[6*b+1]=J[4*b+1],E[6*b+2]=J[4*b+2],E[6*b+3]=J[4*b+3]}if(2==B&&1==k){for(b=0;b<G;b++)J[2*b]=E[4*b],J[2*b+1]=E[4*b+1];d(J,o,2*L,S,0,1,1,s);for(b=0;b<G;b++)E[4*b]=J[2*b],E[4*b+1]=J[2*b+1]}for(var N=E.slice(0),O=0;O<g;O++)if(2==k)for(var W=0;W<F;W++){var j=((O>>>1)*L+(W>>>1))*C,R=2*(1&O)+(1&W);E[Q=(O*F+W)*w]=N[j+R],E[Q+1]=N[j+4],E[Q+2]=N[j+5]}else for(W=0;W<F;W++){var Q;j=(O*L+(W>>>1))*C,R=1&W;E[Q=(O*F+W)*w]=N[j+R],E[Q+1]=N[j+2],E[Q+2]=N[j+3]}}else if(v(E,F*w,D,I,w,g),0==l)d(E,o,F,g,0,w,w,s);else{var q=Math.floor(l/F);for(O=0;O<g;O+=q){var Z=E.slice(O*F*w,(O+q)*F*w);d(Z,o,F,q,0,w,w,s),E.set(Z,O*F*w)}}}return E}}(),function(){var r=2,e=4,t=5,n=6,i=7,a=12,f=13,o=14,u=15,s=17;function l(r){var e={c:new Int8Array(2<<r.u)};return function(r,e,t){var n=[e,3*e+18,5*e+67,7*e+276,t];r.o=e,r.w=(n[4]+2*e)/(2*e+1)+1|0,r.v=Math.ceil(Math.log2(r.w)),r.t=9,function(r,e){for(var t=-e[4],n=0;t<=e[4];n++,t++)r[n]=t<=-e[3]?-4:t<=-e[2]?-3:t<=-e[1]?-2:t<-e[0]?-1:t<=e[0]?0:t<e[1]?1:t<e[2]?2:t<e[3]?3:4}(r.c,n)}(e,0,r.g),e}function v(r){for(var e=[[],[],[]],t=Math.max(2,r.w+32>>>6),n=0;n<3;n++)for(var i=0;i<41;i++)e[n][i]=[t,1];return e}function c(r,e){var t=0,n=8-r.a;r.j,r.a;if(e){if(e>=n)do{t<<=n,e-=n,t|=r[r.j]&(1<<n)-1,r.j++,n=8}while(e>=8);e&&(t<<=e,n-=e,t|=r[r.j]>>>n&(1<<e)-1),r.a=8-n}return t}function d(r,e,t,n,i,a,f,o){null==o&&(o=0);var u,s,l,v,d,h,U=a+1,I=U%2,w=0,g=n[i],F=n[i-1],T=n[i-2][U],_=F[U-1],b=F[U],p=F[U+1],m=g[U-1],A=g[U+1],y=Math.abs;if(I&&(l=y(p-b),v=y(T-b),d=y(_-b)),I){if(h=(h=l>d&&v<l?T+_:l<d&&v<d?T+p:p+_)+2*b>>>2,o)return void(g[U]=h);u=e.t*e.c[r.g+b-T]+e.c[r.g+_-b]}else h=b>_&&b>p||b<_&&b<p?A+m+2*b>>>2:m+A>>>1,u=e.t*e.c[r.g+b-_]+e.c[r.g+_-m];s=y(u);var E=function(r){for(var e=-1,t=0;!t;e++)t=r[r.j]>>>7-r.a&1,r.a++,r.a&=7,r.a||r.j++;return e}(t);if(E<r.n-e.v-1){var D=function(r,e){var t=0;if(e<r)for(;t<=14&&e<<++t<r;);return t}(f[s][0],f[s][1]);w=c(t,D)+(E<<D)}else w=c(t,e.v)+1;w=1&w?-1-(w>>>1):w>>>1,f[s][0]+=y(w),f[s][1]==r.f&&(f[s][0]>>>=1,f[s][1]>>>=1),f[s][1]++,h=u<0?h-w:h+w,r.i&&(h<0?h+=e.w:h>r.g&&(h-=e.w)),g[U]=h>=0?Math.min(h,r.g):0}function h(r,e,t){for(var n=r[0].length,i=e;i<=t;i++)r[i][0]=r[i-1][1],r[i][n-1]=r[i-1][n-2]}function U(t){h(t,i,a),h(t,r,e),h(t,u,s)}function I(r,t,n,i,a,o,u,s,l,v,c,h,I){for(var w=0,g=1,F=a<f&&a>e;g<r.m;)w<r.m&&(d(r,t,n,i,a,w,u[l],r.h&&(F&&v||!F&&(c||(w&h)==I))),d(r,t,n,i,o,w,u[l],r.h&&(!F&&v||F&&(c||(w&h)==I))),w+=2),w>8&&(d(r,t,n,i,a,g,s[l]),d(r,t,n,i,o,g,s[l]),g+=2);U(i)}function w(t,n,f,o,l,v){I(t,n,f,o,r,i,l,v,0,0,1,0,8),I(t,n,f,o,8,u,l,v,1,0,1,0,8),I(t,n,f,o,3,9,l,v,2,1,0,3,0),I(t,n,f,o,10,16,l,v,0,0,0,3,2),I(t,n,f,o,e,11,l,v,1,0,0,3,2),I(t,n,f,o,a,s,l,v,2,1,0,3,0)}function g(e,t,n,a,f,o){var s=o.length,l=e.l;f+1==e.s&&(l=e.e-f*e.l);for(var v=6*e.e*a+f*e.l,c=0;c<6;c++){for(var d=0;d<l;d++){var h,U=o[c%s][d%s];h=0==U?r+(c>>>1):2==U?u+(c>>>1):i+c;var I=e.h?(2*d/3&2147483646|d%3&1)+(d%3>>>1):d>>>1;t[v+d]=n[h][I+1]}v+=e.e}}UTIF._decompressRAF=function(i,u){var c=function(r){var e=UTIF._binBE.readUshort,t={b:e(r,0),i:r[2],C:r[3],u:r[4],q:e(r,5),k:e(r,7),e:e(r,9),l:e(r,11),s:r[13],d:e(r,14)};if(18771!=t.b||t.i>1||t.q<6||t.q%6||t.e<768||t.e%24||768!=t.l||t.k<t.l||t.k%t.l||t.k-t.e>=t.l||t.s>16||t.s!=t.k/t.l||t.s!=Math.ceil(t.e/t.l)||t.d!=t.q/6||12!=t.u&&14!=t.u&&16!=t.u||16!=t.C&&0!=t.C)throw"Invalid data";if(0==t.i)throw"Not implemented. We need this file!";return t.h=16==t.C,t.m=0|(t.h?2*t.l/3:t.l>>>1),t.A=t.m+2,t.f=64,t.g=(1<<t.u)-1,t.n=4*t.u,t}(i),d=function(r,e){var t=new Array(e.s),n=4*e.s,i=16+n;12&n&&(i+=16-(12&n));for(var a=0,f=16;a<e.s;f+=4){var o=UTIF._binBE.readUint(r,f);t[a]=r.slice(i,i+o),t[a].j=0,t[a].a=0,i+=o,a++}if(i!=r.length)throw"Invalid data";return t}(i,c),h=l(c),I=new Int16Array(c.e*c.q);null==u&&(u=c.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var F=[[0,3],[1,e],[t,11],[n,a],[f,16],[o,s]],T=[],_=0;_<18;_++)T[_]=new Uint16Array(c.A);for(var b=0;b<c.s;b++){var p=v(h),m=v(h);for(_=0;_<18;_++)for(var A=0;A<c.A;A++)T[_][A]=0;for(var y=0;y<c.d;y++){w(c,h,d[b],T,p,m);for(_=0;_<6;_++)for(A=0;A<c.A;A++)T[F[_][0]][A]=T[F[_][1]][A];g(c,I,T,y,b,u);for(_=r;_<18;_++)if(-1==[t,n,f,o].indexOf(_))for(A=0;A<c.A;A++)T[_][A]=0;U(T)}}return I}}();export default UTIF;
//# sourceMappingURL=utif.module.js.map