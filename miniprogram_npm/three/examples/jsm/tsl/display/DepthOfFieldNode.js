import{TempNode,NodeUpdateType}from"three/webgpu";import{convertToTexture,nodeObject,Fn,uv,uniform,vec2,vec4,clamp}from"three/tsl";class DepthOfFieldNode extends TempNode{static get type(){return"DepthOfFieldNode"}constructor(d,e,u,a,l){super("vec4"),this.textureNode=d,this.viewZNode=e,this.focusNode=u,this.apertureNode=a,this.maxblurNode=l,this._aspect=uniform(0),this.updateBeforeType=NodeUpdateType.FRAME}updateBefore(){const d=this.textureNode.value;this._aspect.value=d.image.width/d.image.height}setup(){const d=this.textureNode,e=d.uvNode||uv(),u=e=>d.sample(e);return Fn((()=>{const d=vec2(1,this._aspect),a=this.focusNode.add(this.viewZNode),l=vec2(clamp(a.mul(this.apertureNode),this.maxblurNode.negate(),this.maxblurNode)),m=l.mul(.9),t=l.mul(.7),c=l.mul(.4);let v=vec4(0);return v=v.add(u(e)),v=v.add(u(e.add(vec2(0,.4).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.15,.37).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.29,.29).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.37,.15).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.4,0).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.37,-.15).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.29,-.29).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.15,-.37).mul(d).mul(l)))),v=v.add(u(e.add(vec2(0,-.4).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.15,.37).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.29,.29).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.37,.15).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.4,0).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.37,-.15).mul(d).mul(l)))),v=v.add(u(e.add(vec2(-.29,-.29).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.15,-.37).mul(d).mul(l)))),v=v.add(u(e.add(vec2(.15,.37).mul(d).mul(m)))),v=v.add(u(e.add(vec2(-.37,.15).mul(d).mul(m)))),v=v.add(u(e.add(vec2(.37,-.15).mul(d).mul(m)))),v=v.add(u(e.add(vec2(-.15,-.37).mul(d).mul(m)))),v=v.add(u(e.add(vec2(-.15,.37).mul(d).mul(m)))),v=v.add(u(e.add(vec2(.37,.15).mul(d).mul(m)))),v=v.add(u(e.add(vec2(-.37,-.15).mul(d).mul(m)))),v=v.add(u(e.add(vec2(.15,-.37).mul(d).mul(m)))),v=v.add(u(e.add(vec2(.29,.29).mul(d).mul(t)))),v=v.add(u(e.add(vec2(.4,0).mul(d).mul(t)))),v=v.add(u(e.add(vec2(.29,-.29).mul(d).mul(t)))),v=v.add(u(e.add(vec2(0,-.4).mul(d).mul(t)))),v=v.add(u(e.add(vec2(-.29,.29).mul(d).mul(t)))),v=v.add(u(e.add(vec2(-.4,0).mul(d).mul(t)))),v=v.add(u(e.add(vec2(-.29,-.29).mul(d).mul(t)))),v=v.add(u(e.add(vec2(0,.4).mul(d).mul(t)))),v=v.add(u(e.add(vec2(.29,.29).mul(d).mul(c)))),v=v.add(u(e.add(vec2(.4,0).mul(d).mul(c)))),v=v.add(u(e.add(vec2(.29,-.29).mul(d).mul(c)))),v=v.add(u(e.add(vec2(0,-.4).mul(d).mul(c)))),v=v.add(u(e.add(vec2(-.29,.29).mul(d).mul(c)))),v=v.add(u(e.add(vec2(-.4,0).mul(d).mul(c)))),v=v.add(u(e.add(vec2(-.29,-.29).mul(d).mul(c)))),v=v.add(u(e.add(vec2(0,.4).mul(d).mul(c)))),v=v.div(41),v.a=1,vec4(v)}))()}}export default DepthOfFieldNode;export const dof=(d,e,u=1,a=.025,l=1)=>nodeObject(new DepthOfFieldNode(convertToTexture(d),nodeObject(e),nodeObject(u),nodeObject(a),nodeObject(l)));
//# sourceMappingURL=DepthOfFieldNode.js.map