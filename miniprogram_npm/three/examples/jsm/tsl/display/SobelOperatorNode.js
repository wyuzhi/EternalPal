import{Vector2,TempNode,NodeUpdateType}from"three/webgpu";import{nodeObject,Fn,uv,uniform,convertToTexture,vec2,vec3,vec4,mat3,luminance,add}from"three/tsl";class SobelOperatorNode extends TempNode{static get type(){return"SobelOperatorNode"}constructor(e){super("vec4"),this.textureNode=e,this.updateBeforeType=NodeUpdateType.FRAME,this._invSize=uniform(new Vector2)}updateBefore(){const e=this.textureNode.value;this._invSize.value.set(1/e.image.width,1/e.image.height)}setup(){const{textureNode:e}=this,u=e.uvNode||uv(),t=u=>e.sample(u);return Fn((()=>{const e=this._invSize,m=mat3(-1,-2,-1,0,0,0,1,2,1),l=mat3(-1,0,1,-2,0,2,-1,0,1),d=luminance(t(u.add(e.mul(vec2(-1,-1)))).xyz),o=luminance(t(u.add(e.mul(vec2(-1,0)))).xyz),a=luminance(t(u.add(e.mul(vec2(-1,1)))).xyz),n=luminance(t(u.add(e.mul(vec2(0,-1)))).xyz),c=luminance(t(u.add(e.mul(vec2(0,0)))).xyz),r=luminance(t(u.add(e.mul(vec2(0,1)))).xyz),i=luminance(t(u.add(e.mul(vec2(1,-1)))).xyz),v=luminance(t(u.add(e.mul(vec2(1,0)))).xyz),s=luminance(t(u.add(e.mul(vec2(1,1)))).xyz),p=add(m[0][0].mul(d),m[1][0].mul(n),m[2][0].mul(i),m[0][1].mul(o),m[1][1].mul(c),m[2][1].mul(v),m[0][2].mul(a),m[1][2].mul(r),m[2][2].mul(s)),x=add(l[0][0].mul(d),l[1][0].mul(n),l[2][0].mul(i),l[0][1].mul(o),l[1][1].mul(c),l[2][1].mul(v),l[0][2].mul(a),l[1][2].mul(r),l[2][2].mul(s)),y=p.mul(p).add(x.mul(x)).sqrt();return vec4(vec3(y),1)}))()}}export default SobelOperatorNode;export const sobel=e=>nodeObject(new SobelOperatorNode(convertToTexture(e)));
//# sourceMappingURL=SobelOperatorNode.js.map