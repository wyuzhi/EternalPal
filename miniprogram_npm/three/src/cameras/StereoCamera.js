import{Matrix4}from"../math/Matrix4.js";import{DEG2RAD}from"../math/MathUtils.js";import{PerspectiveCamera}from"./PerspectiveCamera.js";const _eyeRight=new Matrix4,_eyeLeft=new Matrix4,_projectionMatrix=new Matrix4;class StereoCamera{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,_projectionMatrix.copy(e.projectionMatrix);const a=t.eyeSep/2,r=a*t.near/t.focus,o=t.near*Math.tan(DEG2RAD*t.fov*.5)/t.zoom;let i,s;_eyeLeft.elements[12]=-a,_eyeRight.elements[12]=a,i=-o*t.aspect+r,s=o*t.aspect+r,_projectionMatrix.elements[0]=2*t.near/(s-i),_projectionMatrix.elements[8]=(s+i)/(s-i),this.cameraL.projectionMatrix.copy(_projectionMatrix),i=-o*t.aspect-r,s=o*t.aspect-r,_projectionMatrix.elements[0]=2*t.near/(s-i),_projectionMatrix.elements[8]=(s+i)/(s-i),this.cameraR.projectionMatrix.copy(_projectionMatrix)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(_eyeRight)}}export{StereoCamera};
//# sourceMappingURL=StereoCamera.js.map