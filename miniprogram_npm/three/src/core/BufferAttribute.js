import{Vector3}from"../math/Vector3.js";import{Vector2}from"../math/Vector2.js";import{denormalize,normalize}from"../math/MathUtils.js";import{StaticDrawUsage,FloatType}from"../constants.js";import{fromHalfFloat,toHalfFloat}from"../extras/DataUtils.js";const _vector=new Vector3,_vector2=new Vector2;let _id=0;class BufferAttribute{constructor(t,r,e=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:_id++}),this.name="",this.array=t,this.itemSize=r,this.count=void 0!==t?t.length/r:0,this.normalized=e,this.usage=StaticDrawUsage,this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(t){!0===t&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,r){this.updateRanges.push({start:t,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,r,e){t*=this.itemSize,e*=r.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[t+i]=r.array[e+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(2===this.itemSize)for(let r=0,e=this.count;r<e;r++)_vector2.fromBufferAttribute(this,r),_vector2.applyMatrix3(t),this.setXY(r,_vector2.x,_vector2.y);else if(3===this.itemSize)for(let r=0,e=this.count;r<e;r++)_vector.fromBufferAttribute(this,r),_vector.applyMatrix3(t),this.setXYZ(r,_vector.x,_vector.y,_vector.z);return this}applyMatrix4(t){for(let r=0,e=this.count;r<e;r++)_vector.fromBufferAttribute(this,r),_vector.applyMatrix4(t),this.setXYZ(r,_vector.x,_vector.y,_vector.z);return this}applyNormalMatrix(t){for(let r=0,e=this.count;r<e;r++)_vector.fromBufferAttribute(this,r),_vector.applyNormalMatrix(t),this.setXYZ(r,_vector.x,_vector.y,_vector.z);return this}transformDirection(t){for(let r=0,e=this.count;r<e;r++)_vector.fromBufferAttribute(this,r),_vector.transformDirection(t),this.setXYZ(r,_vector.x,_vector.y,_vector.z);return this}set(t,r=0){return this.array.set(t,r),this}getComponent(t,r){let e=this.array[t*this.itemSize+r];return this.normalized&&(e=denormalize(e,this.array)),e}setComponent(t,r,e){return this.normalized&&(e=normalize(e,this.array)),this.array[t*this.itemSize+r]=e,this}getX(t){let r=this.array[t*this.itemSize];return this.normalized&&(r=denormalize(r,this.array)),r}setX(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize]=r,this}getY(t){let r=this.array[t*this.itemSize+1];return this.normalized&&(r=denormalize(r,this.array)),r}setY(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+1]=r,this}getZ(t){let r=this.array[t*this.itemSize+2];return this.normalized&&(r=denormalize(r,this.array)),r}setZ(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+2]=r,this}getW(t){let r=this.array[t*this.itemSize+3];return this.normalized&&(r=denormalize(r,this.array)),r}setW(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+3]=r,this}setXY(t,r,e){return t*=this.itemSize,this.normalized&&(r=normalize(r,this.array),e=normalize(e,this.array)),this.array[t+0]=r,this.array[t+1]=e,this}setXYZ(t,r,e,i){return t*=this.itemSize,this.normalized&&(r=normalize(r,this.array),e=normalize(e,this.array),i=normalize(i,this.array)),this.array[t+0]=r,this.array[t+1]=e,this.array[t+2]=i,this}setXYZW(t,r,e,i,a){return t*=this.itemSize,this.normalized&&(r=normalize(r,this.array),e=normalize(e,this.array),i=normalize(i,this.array),a=normalize(a,this.array)),this.array[t+0]=r,this.array[t+1]=e,this.array[t+2]=i,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),this.usage!==StaticDrawUsage&&(t.usage=this.usage),t}}class Int8BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Int8Array(t),r,e)}}class Uint8BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Uint8Array(t),r,e)}}class Uint8ClampedBufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Uint8ClampedArray(t),r,e)}}class Int16BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Int16Array(t),r,e)}}class Uint16BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Uint16Array(t),r,e)}}class Int32BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Int32Array(t),r,e)}}class Uint32BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Uint32Array(t),r,e)}}class Float16BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Uint16Array(t),r,e),this.isFloat16BufferAttribute=!0}getX(t){let r=fromHalfFloat(this.array[t*this.itemSize]);return this.normalized&&(r=denormalize(r,this.array)),r}setX(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize]=toHalfFloat(r),this}getY(t){let r=fromHalfFloat(this.array[t*this.itemSize+1]);return this.normalized&&(r=denormalize(r,this.array)),r}setY(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+1]=toHalfFloat(r),this}getZ(t){let r=fromHalfFloat(this.array[t*this.itemSize+2]);return this.normalized&&(r=denormalize(r,this.array)),r}setZ(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+2]=toHalfFloat(r),this}getW(t){let r=fromHalfFloat(this.array[t*this.itemSize+3]);return this.normalized&&(r=denormalize(r,this.array)),r}setW(t,r){return this.normalized&&(r=normalize(r,this.array)),this.array[t*this.itemSize+3]=toHalfFloat(r),this}setXY(t,r,e){return t*=this.itemSize,this.normalized&&(r=normalize(r,this.array),e=normalize(e,this.array)),this.array[t+0]=toHalfFloat(r),this.array[t+1]=toHalfFloat(e),this}setXYZ(t,r,e,i){return t*=this.itemSize,this.normalized&&(r=normalize(r,this.array),e=normalize(e,this.array),i=normalize(i,this.array)),this.array[t+0]=toHalfFloat(r),this.array[t+1]=toHalfFloat(e),this.array[t+2]=toHalfFloat(i),this}setXYZW(t,r,e,i,a){return t*=this.itemSize,this.normalized&&(r=normalize(r,this.array),e=normalize(e,this.array),i=normalize(i,this.array),a=normalize(a,this.array)),this.array[t+0]=toHalfFloat(r),this.array[t+1]=toHalfFloat(e),this.array[t+2]=toHalfFloat(i),this.array[t+3]=toHalfFloat(a),this}}class Float32BufferAttribute extends BufferAttribute{constructor(t,r,e){super(new Float32Array(t),r,e)}}export{Float32BufferAttribute,Float16BufferAttribute,Uint32BufferAttribute,Int32BufferAttribute,Uint16BufferAttribute,Int16BufferAttribute,Uint8ClampedBufferAttribute,Uint8BufferAttribute,Int8BufferAttribute,BufferAttribute};
//# sourceMappingURL=BufferAttribute.js.map