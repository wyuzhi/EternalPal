{"version":3,"file":"node_modules/three/src/extras/ImageUtils.js","names":["createElementNS","SRGBToLinear","_canvas","ImageUtils","getDataURL","image","type","test","src","HTMLCanvasElement","canvas","undefined","width","height","context","getContext","ImageData","putImageData","drawImage","toDataURL","sRGBToLinear","HTMLImageElement","ImageBitmap","imageData","getImageData","data","i","length","slice","Uint8Array","Uint8ClampedArray","Math","floor","console","warn"],"sources":["node_modules/three/src/extras/ImageUtils.js"],"sourcesContent":["import { createElementNS } from '../utils.js';\nimport { SRGBToLinear } from '../math/ColorManagement.js';\n\nlet _canvas;\n\n/**\n * A class containing utility functions for images.\n *\n * @hideconstructor\n */\nclass ImageUtils {\n\n\t/**\n\t * Returns a data URI containing a representation of the given image.\n\t *\n\t * @param {(HTMLImageElement|HTMLCanvasElement)} image - The image object.\n\t * @param {string} [type='image/png'] - Indicates the image format.\n\t * @return {string} The data URI.\n\t */\n\tstatic getDataURL( image, type = 'image/png' ) {\n\n\t\tif ( /^data:/i.test( image.src ) ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tif ( typeof HTMLCanvasElement === 'undefined' ) {\n\n\t\t\treturn image.src;\n\n\t\t}\n\n\t\tlet canvas;\n\n\t\tif ( image instanceof HTMLCanvasElement ) {\n\n\t\t\tcanvas = image;\n\n\t\t} else {\n\n\t\t\tif ( _canvas === undefined ) _canvas = createElementNS( 'canvas' );\n\n\t\t\t_canvas.width = image.width;\n\t\t\t_canvas.height = image.height;\n\n\t\t\tconst context = _canvas.getContext( '2d' );\n\n\t\t\tif ( image instanceof ImageData ) {\n\n\t\t\t\tcontext.putImageData( image, 0, 0 );\n\n\t\t\t} else {\n\n\t\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\t}\n\n\t\t\tcanvas = _canvas;\n\n\t\t}\n\n\t\treturn canvas.toDataURL( type );\n\n\t}\n\n\t/**\n\t * Converts the given sRGB image data to linear color space.\n\t *\n\t * @param {(HTMLImageElement|HTMLCanvasElement|ImageBitmap|Object)} image - The image object.\n\t * @return {HTMLCanvasElement|Object} The converted image.\n\t */\n\tstatic sRGBToLinear( image ) {\n\n\t\tif ( ( typeof HTMLImageElement !== 'undefined' && image instanceof HTMLImageElement ) ||\n\t\t\t( typeof HTMLCanvasElement !== 'undefined' && image instanceof HTMLCanvasElement ) ||\n\t\t\t( typeof ImageBitmap !== 'undefined' && image instanceof ImageBitmap ) ) {\n\n\t\t\tconst canvas = createElementNS( 'canvas' );\n\n\t\t\tcanvas.width = image.width;\n\t\t\tcanvas.height = image.height;\n\n\t\t\tconst context = canvas.getContext( '2d' );\n\t\t\tcontext.drawImage( image, 0, 0, image.width, image.height );\n\n\t\t\tconst imageData = context.getImageData( 0, 0, image.width, image.height );\n\t\t\tconst data = imageData.data;\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] / 255 ) * 255;\n\n\t\t\t}\n\n\t\t\tcontext.putImageData( imageData, 0, 0 );\n\n\t\t\treturn canvas;\n\n\t\t} else if ( image.data ) {\n\n\t\t\tconst data = image.data.slice( 0 );\n\n\t\t\tfor ( let i = 0; i < data.length; i ++ ) {\n\n\t\t\t\tif ( data instanceof Uint8Array || data instanceof Uint8ClampedArray ) {\n\n\t\t\t\t\tdata[ i ] = Math.floor( SRGBToLinear( data[ i ] / 255 ) * 255 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// assuming float\n\n\t\t\t\t\tdata[ i ] = SRGBToLinear( data[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdata: data,\n\t\t\t\twidth: image.width,\n\t\t\t\theight: image.height\n\t\t\t};\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied.' );\n\t\t\treturn image;\n\n\t\t}\n\n\t}\n\n}\n\nexport { ImageUtils };\n"],"mappings":"OAASA,oBAAuB,qBACvBC,iBAAoB,6BAE7B,IAAIC,QAOJ,MAAMC,WASL,iBAAOC,CAAYC,EAAOC,EAAO,aAEhC,GAAK,UAAUC,KAAMF,EAAMG,KAE1B,OAAOH,EAAMG,IAId,GAAkC,oBAAtBC,kBAEX,OAAOJ,EAAMG,IAId,IAAIE,EAEJ,GAAKL,aAAiBI,kBAErBC,EAASL,MAEH,MAEWM,IAAZT,UAAwBA,QAAUF,gBAAiB,WAExDE,QAAQU,MAAQP,EAAMO,MACtBV,QAAQW,OAASR,EAAMQ,OAEvB,MAAMC,EAAUZ,QAAQa,WAAY,MAE/BV,aAAiBW,UAErBF,EAAQG,aAAcZ,EAAO,EAAG,GAIhCS,EAAQI,UAAWb,EAAO,EAAG,EAAGA,EAAMO,MAAOP,EAAMQ,QAIpDH,EAASR,OAEV,CAEA,OAAOQ,EAAOS,UAAWb,EAE1B,CAQA,mBAAOc,CAAcf,GAEpB,GAAmC,oBAArBgB,kBAAoChB,aAAiBgB,kBACnC,oBAAtBZ,mBAAqCJ,aAAiBI,mBACtC,oBAAhBa,aAA+BjB,aAAiBiB,YAAgB,CAEzE,MAAMZ,EAASV,gBAAiB,UAEhCU,EAAOE,MAAQP,EAAMO,MACrBF,EAAOG,OAASR,EAAMQ,OAEtB,MAAMC,EAAUJ,EAAOK,WAAY,MACnCD,EAAQI,UAAWb,EAAO,EAAG,EAAGA,EAAMO,MAAOP,EAAMQ,QAEnD,MAAMU,EAAYT,EAAQU,aAAc,EAAG,EAAGnB,EAAMO,MAAOP,EAAMQ,QAC3DY,EAAOF,EAAUE,KAEvB,IAAM,IAAIC,EAAI,EAAGA,EAAID,EAAKE,OAAQD,IAEjCD,EAAMC,GAAwC,IAAlCzB,aAAcwB,EAAMC,GAAM,KAMvC,OAFAZ,EAAQG,aAAcM,EAAW,EAAG,GAE7Bb,CAER,CAAO,GAAKL,EAAMoB,KAAO,CAExB,MAAMA,EAAOpB,EAAMoB,KAAKG,MAAO,GAE/B,IAAM,IAAIF,EAAI,EAAGA,EAAID,EAAKE,OAAQD,IAE5BD,aAAgBI,YAAcJ,aAAgBK,kBAElDL,EAAMC,GAAMK,KAAKC,MAAyC,IAAlC/B,aAAcwB,EAAMC,GAAM,MAMlDD,EAAMC,GAAMzB,aAAcwB,EAAMC,IAMlC,MAAO,CACND,KAAMA,EACNb,MAAOP,EAAMO,MACbC,OAAQR,EAAMQ,OAGhB,CAGC,OADAoB,QAAQC,KAAM,+FACP7B,CAIT,SAIQF","ignoreList":[]}