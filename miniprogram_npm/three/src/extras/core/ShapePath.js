import{Color}from"../../math/Color.js";import{Path}from"./Path.js";import{Shape}from"./Shape.js";import{ShapeUtils}from"../ShapeUtils.js";class ShapePath{constructor(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}moveTo(t,e){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e),this}lineTo(t,e){return this.currentPath.lineTo(t,e),this}quadraticCurveTo(t,e,r,h){return this.currentPath.quadraticCurveTo(t,e,r,h),this}bezierCurveTo(t,e,r,h,s,n){return this.currentPath.bezierCurveTo(t,e,r,h,s,n),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t){function e(t,e){const r=e.length;let h=!1;for(let s=r-1,n=0;n<r;s=n++){let r=e[s],o=e[n],i=o.x-r.x,u=o.y-r.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(r=e[n],i=-i,o=e[s],u=-u),t.y<r.y||t.y>o.y)continue;if(t.y===r.y){if(t.x===r.x)return!0}else{const e=u*(t.x-r.x)-i*(t.y-r.y);if(0===e)return!0;if(e<0)continue;h=!h}}else{if(t.y!==r.y)continue;if(o.x<=t.x&&t.x<=r.x||r.x<=t.x&&t.x<=o.x)return!0}}return h}const r=ShapeUtils.isClockWise,h=this.subPaths;if(0===h.length)return[];let s,n,o;const i=[];if(1===h.length)return n=h[0],o=new Shape,o.curves=n.curves,i.push(o),i;let u=!r(h[0].getPoints());u=t?!u:u;const l=[],a=[];let c,p,f=[],P=0;a[P]=void 0,f[P]=[];for(let e=0,o=h.length;e<o;e++)n=h[e],c=n.getPoints(),s=r(c),s=t?!s:s,s?(!u&&a[P]&&P++,a[P]={s:new Shape,p:c},a[P].s.curves=n.curves,u&&P++,f[P]=[]):f[P].push({h:n,p:c[0]});if(!a[0])return function(t){const e=[];for(let r=0,h=t.length;r<h;r++){const h=t[r],s=new Shape;s.curves=h.curves,e.push(s)}return e}(h);if(a.length>1){let t=!1,r=0;for(let t=0,e=a.length;t<e;t++)l[t]=[];for(let h=0,s=a.length;h<s;h++){const s=f[h];for(let n=0;n<s.length;n++){const o=s[n];let i=!0;for(let s=0;s<a.length;s++)e(o.p,a[s].p)&&(h!==s&&r++,i?(i=!1,l[s].push(o)):t=!0);i&&l[h].push(o)}}r>0&&!1===t&&(f=l)}for(let t=0,e=a.length;t<e;t++){o=a[t].s,i.push(o),p=f[t];for(let t=0,e=p.length;t<e;t++)o.holes.push(p[t].h)}return i}}export{ShapePath};
//# sourceMappingURL=ShapePath.js.map