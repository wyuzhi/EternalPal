{"version":3,"file":"node_modules/three/src/math/ColorManagement.js","names":["SRGBColorSpace","LinearSRGBColorSpace","SRGBTransfer","LinearTransfer","NoColorSpace","Matrix3","warnOnce","LINEAR_REC709_TO_XYZ","set","XYZ_TO_LINEAR_REC709","createColorManagement","ColorManagement","enabled","workingColorSpace","spaces","convert","color","sourceColorSpace","targetColorSpace","this","transfer","r","SRGBToLinear","g","b","primaries","applyMatrix3","toXYZ","fromXYZ","LinearToSRGB","workingToColorSpace","colorSpaceToWorking","getPrimaries","colorSpace","getTransfer","getLuminanceCoefficients","target","fromArray","luminanceCoefficients","define","colorSpaces","Object","assign","_getMatrix","targetMatrix","copy","multiply","_getDrawingBufferColorSpace","outputColorSpaceConfig","drawingBufferColorSpace","_getUnpackColorSpace","workingColorSpaceConfig","unpackColorSpace","fromWorkingColorSpace","toWorkingColorSpace","REC709_PRIMARIES","REC709_LUMINANCE_COEFFICIENTS","D65","whitePoint","c","Math","pow"],"sources":["node_modules/three/src/math/ColorManagement.js"],"sourcesContent":["import { SRGBColorSpace, LinearSRGBColorSpace, SRGBTransfer, LinearTransfer, NoColorSpace } from '../constants.js';\nimport { Matrix3 } from './Matrix3.js';\nimport { warnOnce } from '../utils.js';\n\nconst LINEAR_REC709_TO_XYZ = /*@__PURE__*/ new Matrix3().set(\n\t0.4123908, 0.3575843, 0.1804808,\n\t0.2126390, 0.7151687, 0.0721923,\n\t0.0193308, 0.1191948, 0.9505322\n);\n\nconst XYZ_TO_LINEAR_REC709 = /*@__PURE__*/ new Matrix3().set(\n\t3.2409699, - 1.5373832, - 0.4986108,\n\t- 0.9692436, 1.8759675, 0.0415551,\n\t0.0556301, - 0.2039770, 1.0569715\n);\n\nfunction createColorManagement() {\n\n\tconst ColorManagement = {\n\n\t\tenabled: true,\n\n\t\tworkingColorSpace: LinearSRGBColorSpace,\n\n\t\t/**\n\t\t * Implementations of supported color spaces.\n\t\t *\n\t\t * Required:\n\t\t *\t- primaries: chromaticity coordinates [ rx ry gx gy bx by ]\n\t\t *\t- whitePoint: reference white [ x y ]\n\t\t *\t- transfer: transfer function (pre-defined)\n\t\t *\t- toXYZ: Matrix3 RGB to XYZ transform\n\t\t *\t- fromXYZ: Matrix3 XYZ to RGB transform\n\t\t *\t- luminanceCoefficients: RGB luminance coefficients\n\t\t *\n\t\t * Optional:\n\t\t *  - outputColorSpaceConfig: { drawingBufferColorSpace: ColorSpace }\n\t\t *  - workingColorSpaceConfig: { unpackColorSpace: ColorSpace }\n\t\t *\n\t\t * Reference:\n\t\t * - https://www.russellcottrell.com/photo/matrixCalculator.htm\n\t\t */\n\t\tspaces: {},\n\n\t\tconvert: function ( color, sourceColorSpace, targetColorSpace ) {\n\n\t\t\tif ( this.enabled === false || sourceColorSpace === targetColorSpace || ! sourceColorSpace || ! targetColorSpace ) {\n\n\t\t\t\treturn color;\n\n\t\t\t}\n\n\t\t\tif ( this.spaces[ sourceColorSpace ].transfer === SRGBTransfer ) {\n\n\t\t\t\tcolor.r = SRGBToLinear( color.r );\n\t\t\t\tcolor.g = SRGBToLinear( color.g );\n\t\t\t\tcolor.b = SRGBToLinear( color.b );\n\n\t\t\t}\n\n\t\t\tif ( this.spaces[ sourceColorSpace ].primaries !== this.spaces[ targetColorSpace ].primaries ) {\n\n\t\t\t\tcolor.applyMatrix3( this.spaces[ sourceColorSpace ].toXYZ );\n\t\t\t\tcolor.applyMatrix3( this.spaces[ targetColorSpace ].fromXYZ );\n\n\t\t\t}\n\n\t\t\tif ( this.spaces[ targetColorSpace ].transfer === SRGBTransfer ) {\n\n\t\t\t\tcolor.r = LinearToSRGB( color.r );\n\t\t\t\tcolor.g = LinearToSRGB( color.g );\n\t\t\t\tcolor.b = LinearToSRGB( color.b );\n\n\t\t\t}\n\n\t\t\treturn color;\n\n\t\t},\n\n\t\tworkingToColorSpace: function ( color, targetColorSpace ) {\n\n\t\t\treturn this.convert( color, this.workingColorSpace, targetColorSpace );\n\n\t\t},\n\n\t\tcolorSpaceToWorking: function ( color, sourceColorSpace ) {\n\n\t\t\treturn this.convert( color, sourceColorSpace, this.workingColorSpace );\n\n\t\t},\n\n\t\tgetPrimaries: function ( colorSpace ) {\n\n\t\t\treturn this.spaces[ colorSpace ].primaries;\n\n\t\t},\n\n\t\tgetTransfer: function ( colorSpace ) {\n\n\t\t\tif ( colorSpace === NoColorSpace ) return LinearTransfer;\n\n\t\t\treturn this.spaces[ colorSpace ].transfer;\n\n\t\t},\n\n\t\tgetLuminanceCoefficients: function ( target, colorSpace = this.workingColorSpace ) {\n\n\t\t\treturn target.fromArray( this.spaces[ colorSpace ].luminanceCoefficients );\n\n\t\t},\n\n\t\tdefine: function ( colorSpaces ) {\n\n\t\t\tObject.assign( this.spaces, colorSpaces );\n\n\t\t},\n\n\t\t// Internal APIs\n\n\t\t_getMatrix: function ( targetMatrix, sourceColorSpace, targetColorSpace ) {\n\n\t\t\treturn targetMatrix\n\t\t\t\t.copy( this.spaces[ sourceColorSpace ].toXYZ )\n\t\t\t\t.multiply( this.spaces[ targetColorSpace ].fromXYZ );\n\n\t\t},\n\n\t\t_getDrawingBufferColorSpace: function ( colorSpace ) {\n\n\t\t\treturn this.spaces[ colorSpace ].outputColorSpaceConfig.drawingBufferColorSpace;\n\n\t\t},\n\n\t\t_getUnpackColorSpace: function ( colorSpace = this.workingColorSpace ) {\n\n\t\t\treturn this.spaces[ colorSpace ].workingColorSpaceConfig.unpackColorSpace;\n\n\t\t},\n\n\t\t// Deprecated\n\n\t\tfromWorkingColorSpace: function ( color, targetColorSpace ) {\n\n\t\t\twarnOnce( 'THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace().' ); // @deprecated, r177\n\n\t\t\treturn ColorManagement.workingToColorSpace( color, targetColorSpace );\n\n\t\t},\n\n\t\ttoWorkingColorSpace: function ( color, sourceColorSpace ) {\n\n\t\t\twarnOnce( 'THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking().' ); // @deprecated, r177\n\n\t\t\treturn ColorManagement.colorSpaceToWorking( color, sourceColorSpace );\n\n\t\t},\n\n\t};\n\n\t/******************************************************************************\n\t * sRGB definitions\n\t */\n\n\tconst REC709_PRIMARIES = [ 0.640, 0.330, 0.300, 0.600, 0.150, 0.060 ];\n\tconst REC709_LUMINANCE_COEFFICIENTS = [ 0.2126, 0.7152, 0.0722 ];\n\tconst D65 = [ 0.3127, 0.3290 ];\n\n\tColorManagement.define( {\n\n\t\t[ LinearSRGBColorSpace ]: {\n\t\t\tprimaries: REC709_PRIMARIES,\n\t\t\twhitePoint: D65,\n\t\t\ttransfer: LinearTransfer,\n\t\t\ttoXYZ: LINEAR_REC709_TO_XYZ,\n\t\t\tfromXYZ: XYZ_TO_LINEAR_REC709,\n\t\t\tluminanceCoefficients: REC709_LUMINANCE_COEFFICIENTS,\n\t\t\tworkingColorSpaceConfig: { unpackColorSpace: SRGBColorSpace },\n\t\t\toutputColorSpaceConfig: { drawingBufferColorSpace: SRGBColorSpace }\n\t\t},\n\n\t\t[ SRGBColorSpace ]: {\n\t\t\tprimaries: REC709_PRIMARIES,\n\t\t\twhitePoint: D65,\n\t\t\ttransfer: SRGBTransfer,\n\t\t\ttoXYZ: LINEAR_REC709_TO_XYZ,\n\t\t\tfromXYZ: XYZ_TO_LINEAR_REC709,\n\t\t\tluminanceCoefficients: REC709_LUMINANCE_COEFFICIENTS,\n\t\t\toutputColorSpaceConfig: { drawingBufferColorSpace: SRGBColorSpace }\n\t\t},\n\n\t} );\n\n\treturn ColorManagement;\n\n}\n\nexport const ColorManagement = /*@__PURE__*/ createColorManagement();\n\nexport function SRGBToLinear( c ) {\n\n\treturn ( c < 0.04045 ) ? c * 0.0773993808 : Math.pow( c * 0.9478672986 + 0.0521327014, 2.4 );\n\n}\n\nexport function LinearToSRGB( c ) {\n\n\treturn ( c < 0.0031308 ) ? c * 12.92 : 1.055 * ( Math.pow( c, 0.41666 ) ) - 0.055;\n\n}\n"],"mappings":"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","ignoreList":[]}