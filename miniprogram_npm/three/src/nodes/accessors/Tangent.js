import{attribute}from"../core/AttributeNode.js";import{cameraViewMatrix}from"./Camera.js";import{modelViewMatrix}from"./ModelNode.js";import{Fn,vec4}from"../tsl/TSLBase.js";import{tangentViewFrame}from"./TangentUtils.js";import{directionToFaceDirection}from"../display/FrontFacingNode.js";export const tangentGeometry=Fn((t=>(!1===t.geometry.hasAttribute("tangent")&&t.geometry.computeTangents(),attribute("tangent","vec4"))))();export const tangentLocal=tangentGeometry.xyz.toVar("tangentLocal");export const tangentView=Fn((({subBuildFn:t,geometry:e,material:n})=>{let r;return r="VERTEX"===t||e.hasAttribute("tangent")?modelViewMatrix.mul(vec4(tangentLocal,0)).xyz.toVarying("v_tangentView").normalize():tangentViewFrame,!0!==n.flatShading&&(r=directionToFaceDirection(r)),r}),"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView");export const tangentWorld=tangentView.transformDirection(cameraViewMatrix).toVarying("v_tangentWorld").normalize().toVar("tangentWorld");
//# sourceMappingURL=Tangent.js.map