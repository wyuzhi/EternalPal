import{RGBA_ASTC_4x4_Format,RGBA_ASTC_5x4_Format,RGBA_ASTC_5x5_Format,RGBA_ASTC_6x5_Format,RGBA_ASTC_6x6_Format,RGBA_ASTC_8x5_Format,RGBA_ASTC_8x6_Format,RGBA_ASTC_8x8_Format,RGBA_ASTC_10x5_Format,RGBA_ASTC_10x6_Format,RGBA_ASTC_10x8_Format,RGBA_ASTC_10x10_Format,RGBA_ASTC_12x10_Format,RGBA_ASTC_12x12_Format,RGB_ETC1_Format,RGB_ETC2_Format,RGBA_ETC2_EAC_Format,RGBA_PVRTC_2BPPV1_Format,RGBA_PVRTC_4BPPV1_Format,RGB_PVRTC_2BPPV1_Format,RGB_PVRTC_4BPPV1_Format,RGBA_S3TC_DXT5_Format,RGBA_S3TC_DXT3_Format,RGBA_S3TC_DXT1_Format,RGB_S3TC_DXT1_Format,DepthFormat,DepthStencilFormat,RedFormat,RGBFormat,RGBAFormat,AlphaFormat,RedIntegerFormat,RGFormat,RGIntegerFormat,RGBAIntegerFormat,HalfFloatType,FloatType,UnsignedIntType,IntType,UnsignedShortType,ShortType,ByteType,UnsignedInt248Type,UnsignedInt5999Type,UnsignedShort5551Type,UnsignedShort4444Type,UnsignedByteType,RGBA_BPTC_Format,RED_RGTC1_Format,SIGNED_RED_RGTC1_Format,RED_GREEN_RGTC2_Format,SIGNED_RED_GREEN_RGTC2_Format,SRGBTransfer,NoColorSpace}from"../../../constants.js";import{ColorManagement}from"../../../math/ColorManagement.js";class WebGLUtils{constructor(_){this.backend=_,this.gl=this.backend.gl,this.extensions=_.extensions}convert(_,r=NoColorSpace){const{gl:R,extensions:t}=this;let S;const T=ColorManagement.getTransfer(r);if(_===UnsignedByteType)return R.UNSIGNED_BYTE;if(_===UnsignedShort4444Type)return R.UNSIGNED_SHORT_4_4_4_4;if(_===UnsignedShort5551Type)return R.UNSIGNED_SHORT_5_5_5_1;if(_===UnsignedInt5999Type)return R.UNSIGNED_INT_5_9_9_9_REV;if(_===ByteType)return R.BYTE;if(_===ShortType)return R.SHORT;if(_===UnsignedShortType)return R.UNSIGNED_SHORT;if(_===IntType)return R.INT;if(_===UnsignedIntType)return R.UNSIGNED_INT;if(_===FloatType)return R.FLOAT;if(_===HalfFloatType)return R.HALF_FLOAT;if(_===AlphaFormat)return R.ALPHA;if(_===RGBFormat)return R.RGB;if(_===RGBAFormat)return R.RGBA;if(_===DepthFormat)return R.DEPTH_COMPONENT;if(_===DepthStencilFormat)return R.DEPTH_STENCIL;if(_===RedFormat)return R.RED;if(_===RedIntegerFormat)return R.RED_INTEGER;if(_===RGFormat)return R.RG;if(_===RGIntegerFormat)return R.RG_INTEGER;if(_===RGBAIntegerFormat)return R.RGBA_INTEGER;if(_===RGB_S3TC_DXT1_Format||_===RGBA_S3TC_DXT1_Format||_===RGBA_S3TC_DXT3_Format||_===RGBA_S3TC_DXT5_Format)if(T===SRGBTransfer){if(S=t.get("WEBGL_compressed_texture_s3tc_srgb"),null===S)return null;if(_===RGB_S3TC_DXT1_Format)return S.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(_===RGBA_S3TC_DXT1_Format)return S.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(_===RGBA_S3TC_DXT3_Format)return S.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(_===RGBA_S3TC_DXT5_Format)return S.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(S=t.get("WEBGL_compressed_texture_s3tc"),null===S)return null;if(_===RGB_S3TC_DXT1_Format)return S.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===RGBA_S3TC_DXT1_Format)return S.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===RGBA_S3TC_DXT3_Format)return S.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===RGBA_S3TC_DXT5_Format)return S.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(_===RGB_PVRTC_4BPPV1_Format||_===RGB_PVRTC_2BPPV1_Format||_===RGBA_PVRTC_4BPPV1_Format||_===RGBA_PVRTC_2BPPV1_Format){if(S=t.get("WEBGL_compressed_texture_pvrtc"),null===S)return null;if(_===RGB_PVRTC_4BPPV1_Format)return S.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===RGB_PVRTC_2BPPV1_Format)return S.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===RGBA_PVRTC_4BPPV1_Format)return S.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===RGBA_PVRTC_2BPPV1_Format)return S.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(_===RGB_ETC1_Format||_===RGB_ETC2_Format||_===RGBA_ETC2_EAC_Format){if(S=t.get("WEBGL_compressed_texture_etc"),null===S)return null;if(_===RGB_ETC1_Format||_===RGB_ETC2_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ETC2:S.COMPRESSED_RGB8_ETC2;if(_===RGBA_ETC2_EAC_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:S.COMPRESSED_RGBA8_ETC2_EAC}if(_===RGBA_ASTC_4x4_Format||_===RGBA_ASTC_5x4_Format||_===RGBA_ASTC_5x5_Format||_===RGBA_ASTC_6x5_Format||_===RGBA_ASTC_6x6_Format||_===RGBA_ASTC_8x5_Format||_===RGBA_ASTC_8x6_Format||_===RGBA_ASTC_8x8_Format||_===RGBA_ASTC_10x5_Format||_===RGBA_ASTC_10x6_Format||_===RGBA_ASTC_10x8_Format||_===RGBA_ASTC_10x10_Format||_===RGBA_ASTC_12x10_Format||_===RGBA_ASTC_12x12_Format){if(S=t.get("WEBGL_compressed_texture_astc"),null===S)return null;if(_===RGBA_ASTC_4x4_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:S.COMPRESSED_RGBA_ASTC_4x4_KHR;if(_===RGBA_ASTC_5x4_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:S.COMPRESSED_RGBA_ASTC_5x4_KHR;if(_===RGBA_ASTC_5x5_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:S.COMPRESSED_RGBA_ASTC_5x5_KHR;if(_===RGBA_ASTC_6x5_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:S.COMPRESSED_RGBA_ASTC_6x5_KHR;if(_===RGBA_ASTC_6x6_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:S.COMPRESSED_RGBA_ASTC_6x6_KHR;if(_===RGBA_ASTC_8x5_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:S.COMPRESSED_RGBA_ASTC_8x5_KHR;if(_===RGBA_ASTC_8x6_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:S.COMPRESSED_RGBA_ASTC_8x6_KHR;if(_===RGBA_ASTC_8x8_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:S.COMPRESSED_RGBA_ASTC_8x8_KHR;if(_===RGBA_ASTC_10x5_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:S.COMPRESSED_RGBA_ASTC_10x5_KHR;if(_===RGBA_ASTC_10x6_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:S.COMPRESSED_RGBA_ASTC_10x6_KHR;if(_===RGBA_ASTC_10x8_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:S.COMPRESSED_RGBA_ASTC_10x8_KHR;if(_===RGBA_ASTC_10x10_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:S.COMPRESSED_RGBA_ASTC_10x10_KHR;if(_===RGBA_ASTC_12x10_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:S.COMPRESSED_RGBA_ASTC_12x10_KHR;if(_===RGBA_ASTC_12x12_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:S.COMPRESSED_RGBA_ASTC_12x12_KHR}if(_===RGBA_BPTC_Format){if(S=t.get("EXT_texture_compression_bptc"),null===S)return null;if(_===RGBA_BPTC_Format)return T===SRGBTransfer?S.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:S.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(_===RED_RGTC1_Format||_===SIGNED_RED_RGTC1_Format||_===RED_GREEN_RGTC2_Format||_===SIGNED_RED_GREEN_RGTC2_Format){if(S=t.get("EXT_texture_compression_rgtc"),null===S)return null;if(_===RGBA_BPTC_Format)return S.COMPRESSED_RED_RGTC1_EXT;if(_===SIGNED_RED_RGTC1_Format)return S.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(_===RED_GREEN_RGTC2_Format)return S.COMPRESSED_RED_GREEN_RGTC2_EXT;if(_===SIGNED_RED_GREEN_RGTC2_Format)return S.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return _===UnsignedInt248Type?R.UNSIGNED_INT_24_8:void 0!==R[_]?R[_]:null}_clientWaitAsync(){const{gl:_}=this,r=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);return _.flush(),new Promise(((R,t)=>{!function S(){const T=_.clientWaitSync(r,_.SYNC_FLUSH_COMMANDS_BIT,0);if(T===_.WAIT_FAILED)return _.deleteSync(r),void t();T!==_.TIMEOUT_EXPIRED?(_.deleteSync(r),R()):requestAnimationFrame(S)}()}))}}export default WebGLUtils;
//# sourceMappingURL=WebGLUtils.js.map