import{CubeReflectionMapping,CubeRefractionMapping,EquirectangularReflectionMapping,EquirectangularRefractionMapping}from"../../constants.js";import{WebGLCubeRenderTarget}from"../WebGLCubeRenderTarget.js";function WebGLCubeMaps(e){let n=new WeakMap;function t(e,n){return n===EquirectangularReflectionMapping?e.mapping=CubeReflectionMapping:n===EquirectangularRefractionMapping&&(e.mapping=CubeRefractionMapping),e}function i(e){const t=e.target;t.removeEventListener("dispose",i);const r=n.get(t);void 0!==r&&(n.delete(t),r.dispose())}return{get:function(r){if(r&&r.isTexture){const a=r.mapping;if(a===EquirectangularReflectionMapping||a===EquirectangularRefractionMapping){if(n.has(r)){return t(n.get(r).texture,r.mapping)}{const a=r.image;if(a&&a.height>0){const p=new WebGLCubeRenderTarget(a.height);return p.fromEquirectangularTexture(e,r),n.set(r,p),r.addEventListener("dispose",i),t(p.texture,r.mapping)}return null}}}return r},dispose:function(){n=new WeakMap}}}export{WebGLCubeMaps};
//# sourceMappingURL=WebGLCubeMaps.js.map