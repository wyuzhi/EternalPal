{"version":3,"file":"node_modules/three/src/renderers/webgl/WebGLCubeMaps.js","names":["CubeReflectionMapping","CubeRefractionMapping","EquirectangularReflectionMapping","EquirectangularRefractionMapping","WebGLCubeRenderTarget","WebGLCubeMaps","renderer","cubemaps","WeakMap","mapTextureMapping","texture","mapping","onTextureDispose","event","target","removeEventListener","cubemap","get","undefined","delete","dispose","isTexture","has","image","height","renderTarget","fromEquirectangularTexture","set","addEventListener"],"sources":["node_modules/three/src/renderers/webgl/WebGLCubeMaps.js"],"sourcesContent":["import { CubeReflectionMapping, CubeRefractionMapping, EquirectangularReflectionMapping, EquirectangularRefractionMapping } from '../../constants.js';\nimport { WebGLCubeRenderTarget } from '../WebGLCubeRenderTarget.js';\n\nfunction WebGLCubeMaps( renderer ) {\n\n\tlet cubemaps = new WeakMap();\n\n\tfunction mapTextureMapping( texture, mapping ) {\n\n\t\tif ( mapping === EquirectangularReflectionMapping ) {\n\n\t\t\ttexture.mapping = CubeReflectionMapping;\n\n\t\t} else if ( mapping === EquirectangularRefractionMapping ) {\n\n\t\t\ttexture.mapping = CubeRefractionMapping;\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction get( texture ) {\n\n\t\tif ( texture && texture.isTexture ) {\n\n\t\t\tconst mapping = texture.mapping;\n\n\t\t\tif ( mapping === EquirectangularReflectionMapping || mapping === EquirectangularRefractionMapping ) {\n\n\t\t\t\tif ( cubemaps.has( texture ) ) {\n\n\t\t\t\t\tconst cubemap = cubemaps.get( texture ).texture;\n\t\t\t\t\treturn mapTextureMapping( cubemap, texture.mapping );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconst image = texture.image;\n\n\t\t\t\t\tif ( image && image.height > 0 ) {\n\n\t\t\t\t\t\tconst renderTarget = new WebGLCubeRenderTarget( image.height );\n\t\t\t\t\t\trenderTarget.fromEquirectangularTexture( renderer, texture );\n\t\t\t\t\t\tcubemaps.set( texture, renderTarget );\n\n\t\t\t\t\t\ttexture.addEventListener( 'dispose', onTextureDispose );\n\n\t\t\t\t\t\treturn mapTextureMapping( renderTarget.texture, texture.mapping );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// image not yet ready. try the conversion next frame\n\n\t\t\t\t\t\treturn null;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn texture;\n\n\t}\n\n\tfunction onTextureDispose( event ) {\n\n\t\tconst texture = event.target;\n\n\t\ttexture.removeEventListener( 'dispose', onTextureDispose );\n\n\t\tconst cubemap = cubemaps.get( texture );\n\n\t\tif ( cubemap !== undefined ) {\n\n\t\t\tcubemaps.delete( texture );\n\t\t\tcubemap.dispose();\n\n\t\t}\n\n\t}\n\n\tfunction dispose() {\n\n\t\tcubemaps = new WeakMap();\n\n\t}\n\n\treturn {\n\t\tget: get,\n\t\tdispose: dispose\n\t};\n\n}\n\nexport { WebGLCubeMaps };\n"],"mappings":"OAASA,sBAAuBC,sBAAuBC,iCAAkCC,qCAAwC,4BACxHC,0BAA6B,8BAEtC,SAASC,cAAeC,GAEvB,IAAIC,EAAW,IAAIC,QAEnB,SAASC,EAAmBC,EAASC,GAYpC,OAVKA,IAAYT,iCAEhBQ,EAAQC,QAAUX,sBAEPW,IAAYR,mCAEvBO,EAAQC,QAAUV,uBAIZS,CAER,CA+CA,SAASE,EAAkBC,GAE1B,MAAMH,EAAUG,EAAMC,OAEtBJ,EAAQK,oBAAqB,UAAWH,GAExC,MAAMI,EAAUT,EAASU,IAAKP,QAEbQ,IAAZF,IAEJT,EAASY,OAAQT,GACjBM,EAAQI,UAIV,CAQA,MAAO,CACNH,IArED,SAAcP,GAEb,GAAKA,GAAWA,EAAQW,UAAY,CAEnC,MAAMV,EAAUD,EAAQC,QAExB,GAAKA,IAAYT,kCAAoCS,IAAYR,iCAAmC,CAEnG,GAAKI,EAASe,IAAKZ,GAAY,CAG9B,OAAOD,EADSF,EAASU,IAAKP,GAAUA,QACLA,EAAQC,QAE5C,CAAO,CAEN,MAAMY,EAAQb,EAAQa,MAEtB,GAAKA,GAASA,EAAMC,OAAS,EAAI,CAEhC,MAAMC,EAAe,IAAIrB,sBAAuBmB,EAAMC,QAMtD,OALAC,EAAaC,2BAA4BpB,EAAUI,GACnDH,EAASoB,IAAKjB,EAASe,GAEvBf,EAAQkB,iBAAkB,UAAWhB,GAE9BH,EAAmBgB,EAAaf,QAASA,EAAQC,QAEzD,CAIC,OAAO,IAIT,CAED,CAED,CAEA,OAAOD,CAER,EA2BCU,QARD,WAECb,EAAW,IAAIC,OAEhB,EAOD,QAESH","ignoreList":[]}