{"version":3,"file":"node_modules/three/src/renderers/webgl/WebGLGeometries.js","names":["Uint16BufferAttribute","Uint32BufferAttribute","arrayNeedsUint32","WebGLGeometries","gl","attributes","info","bindingStates","geometries","wireframeAttributes","WeakMap","onGeometryDispose","event","geometry","target","index","remove","name","removeEventListener","id","attribute","get","delete","releaseStatesOfGeometry","isInstancedBufferGeometry","_maxInstanceCount","memory","updateWireframeAttribute","indices","geometryIndex","geometryPosition","position","version","array","i","l","length","a","b","c","push","undefined","previousAttribute","set","object","addEventListener","update","geometryAttributes","ARRAY_BUFFER","getWireframeAttribute","currentAttribute"],"sources":["node_modules/three/src/renderers/webgl/WebGLGeometries.js"],"sourcesContent":["import { Uint16BufferAttribute, Uint32BufferAttribute } from '../../core/BufferAttribute.js';\nimport { arrayNeedsUint32 } from '../../utils.js';\n\nfunction WebGLGeometries( gl, attributes, info, bindingStates ) {\n\n\tconst geometries = {};\n\tconst wireframeAttributes = new WeakMap();\n\n\tfunction onGeometryDispose( event ) {\n\n\t\tconst geometry = event.target;\n\n\t\tif ( geometry.index !== null ) {\n\n\t\t\tattributes.remove( geometry.index );\n\n\t\t}\n\n\t\tfor ( const name in geometry.attributes ) {\n\n\t\t\tattributes.remove( geometry.attributes[ name ] );\n\n\t\t}\n\n\t\tgeometry.removeEventListener( 'dispose', onGeometryDispose );\n\n\t\tdelete geometries[ geometry.id ];\n\n\t\tconst attribute = wireframeAttributes.get( geometry );\n\n\t\tif ( attribute ) {\n\n\t\t\tattributes.remove( attribute );\n\t\t\twireframeAttributes.delete( geometry );\n\n\t\t}\n\n\t\tbindingStates.releaseStatesOfGeometry( geometry );\n\n\t\tif ( geometry.isInstancedBufferGeometry === true ) {\n\n\t\t\tdelete geometry._maxInstanceCount;\n\n\t\t}\n\n\t\t//\n\n\t\tinfo.memory.geometries --;\n\n\t}\n\n\tfunction get( object, geometry ) {\n\n\t\tif ( geometries[ geometry.id ] === true ) return geometry;\n\n\t\tgeometry.addEventListener( 'dispose', onGeometryDispose );\n\n\t\tgeometries[ geometry.id ] = true;\n\n\t\tinfo.memory.geometries ++;\n\n\t\treturn geometry;\n\n\t}\n\n\tfunction update( geometry ) {\n\n\t\tconst geometryAttributes = geometry.attributes;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates.\n\n\t\tfor ( const name in geometryAttributes ) {\n\n\t\t\tattributes.update( geometryAttributes[ name ], gl.ARRAY_BUFFER );\n\n\t\t}\n\n\t}\n\n\tfunction updateWireframeAttribute( geometry ) {\n\n\t\tconst indices = [];\n\n\t\tconst geometryIndex = geometry.index;\n\t\tconst geometryPosition = geometry.attributes.position;\n\t\tlet version = 0;\n\n\t\tif ( geometryIndex !== null ) {\n\n\t\t\tconst array = geometryIndex.array;\n\t\t\tversion = geometryIndex.version;\n\n\t\t\tfor ( let i = 0, l = array.length; i < l; i += 3 ) {\n\n\t\t\t\tconst a = array[ i + 0 ];\n\t\t\t\tconst b = array[ i + 1 ];\n\t\t\t\tconst c = array[ i + 2 ];\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t} else if ( geometryPosition !== undefined ) {\n\n\t\t\tconst array = geometryPosition.array;\n\t\t\tversion = geometryPosition.version;\n\n\t\t\tfor ( let i = 0, l = ( array.length / 3 ) - 1; i < l; i += 3 ) {\n\n\t\t\t\tconst a = i + 0;\n\t\t\t\tconst b = i + 1;\n\t\t\t\tconst c = i + 2;\n\n\t\t\t\tindices.push( a, b, b, c, c, a );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst attribute = new ( arrayNeedsUint32( indices ) ? Uint32BufferAttribute : Uint16BufferAttribute )( indices, 1 );\n\t\tattribute.version = version;\n\n\t\t// Updating index buffer in VAO now. See WebGLBindingStates\n\n\t\t//\n\n\t\tconst previousAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( previousAttribute ) attributes.remove( previousAttribute );\n\n\t\t//\n\n\t\twireframeAttributes.set( geometry, attribute );\n\n\t}\n\n\tfunction getWireframeAttribute( geometry ) {\n\n\t\tconst currentAttribute = wireframeAttributes.get( geometry );\n\n\t\tif ( currentAttribute ) {\n\n\t\t\tconst geometryIndex = geometry.index;\n\n\t\t\tif ( geometryIndex !== null ) {\n\n\t\t\t\t// if the attribute is obsolete, create a new one\n\n\t\t\t\tif ( currentAttribute.version < geometryIndex.version ) {\n\n\t\t\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tupdateWireframeAttribute( geometry );\n\n\t\t}\n\n\t\treturn wireframeAttributes.get( geometry );\n\n\t}\n\n\treturn {\n\n\t\tget: get,\n\t\tupdate: update,\n\n\t\tgetWireframeAttribute: getWireframeAttribute\n\n\t};\n\n}\n\n\nexport { WebGLGeometries };\n"],"mappings":"OAASA,sBAAuBC,0BAA6B,uCACpDC,qBAAwB,iBAEjC,SAASC,gBAAiBC,EAAIC,EAAYC,EAAMC,GAE/C,MAAMC,EAAa,CAAC,EACdC,EAAsB,IAAIC,QAEhC,SAASC,EAAmBC,GAE3B,MAAMC,EAAWD,EAAME,OAEC,OAAnBD,EAASE,OAEbV,EAAWW,OAAQH,EAASE,OAI7B,IAAM,MAAME,KAAQJ,EAASR,WAE5BA,EAAWW,OAAQH,EAASR,WAAYY,IAIzCJ,EAASK,oBAAqB,UAAWP,UAElCH,EAAYK,EAASM,IAE5B,MAAMC,EAAYX,EAAoBY,IAAKR,GAEtCO,IAEJf,EAAWW,OAAQI,GACnBX,EAAoBa,OAAQT,IAI7BN,EAAcgB,wBAAyBV,IAEK,IAAvCA,EAASW,kCAENX,EAASY,kBAMjBnB,EAAKoB,OAAOlB,YAEb,CA8BA,SAASmB,EAA0Bd,GAElC,MAAMe,EAAU,GAEVC,EAAgBhB,EAASE,MACzBe,EAAmBjB,EAASR,WAAW0B,SAC7C,IAAIC,EAAU,EAEd,GAAuB,OAAlBH,EAAyB,CAE7B,MAAMI,EAAQJ,EAAcI,MAC5BD,EAAUH,EAAcG,QAExB,IAAM,IAAIE,EAAI,EAAGC,EAAIF,EAAMG,OAAQF,EAAIC,EAAGD,GAAK,EAAI,CAElD,MAAMG,EAAIJ,EAAOC,EAAI,GACfI,EAAIL,EAAOC,EAAI,GACfK,EAAIN,EAAOC,EAAI,GAErBN,EAAQY,KAAMH,EAAGC,EAAGA,EAAGC,EAAGA,EAAGF,EAE9B,CAED,KAAO,SAA0BI,IAArBX,EAiBX,OAjB4C,CAE5C,MAAMG,EAAQH,EAAiBG,MAC/BD,EAAUF,EAAiBE,QAE3B,IAAM,IAAIE,EAAI,EAAGC,EAAMF,EAAMG,OAAS,EAAM,EAAGF,EAAIC,EAAGD,GAAK,EAAI,CAE9D,MAAMG,EAAIH,EAAI,EACRI,EAAIJ,EAAI,EACRK,EAAIL,EAAI,EAEdN,EAAQY,KAAMH,EAAGC,EAAGA,EAAGC,EAAGA,EAAGF,EAE9B,CAED,CAIA,CAEA,MAAMjB,EAAY,IAAMlB,iBAAkB0B,GAAY3B,sBAAwBD,uBAAyB4B,EAAS,GAChHR,EAAUY,QAAUA,EAMpB,MAAMU,EAAoBjC,EAAoBY,IAAKR,GAE9C6B,GAAoBrC,EAAWW,OAAQ0B,GAI5CjC,EAAoBkC,IAAK9B,EAAUO,EAEpC,CAgCA,MAAO,CAENC,IAzHD,SAAcuB,EAAQ/B,GAErB,OAAmC,IAA9BL,EAAYK,EAASM,MAE1BN,EAASgC,iBAAkB,UAAWlC,GAEtCH,EAAYK,EAASM,KAAO,EAE5Bb,EAAKoB,OAAOlB,cANqCK,CAUlD,EA8GCiC,OA5GD,SAAiBjC,GAEhB,MAAMkC,EAAqBlC,EAASR,WAIpC,IAAM,MAAMY,KAAQ8B,EAEnB1C,EAAWyC,OAAQC,EAAoB9B,GAAQb,EAAG4C,aAIpD,EAkGCC,sBAnCD,SAAgCpC,GAE/B,MAAMqC,EAAmBzC,EAAoBY,IAAKR,GAElD,GAAKqC,EAAmB,CAEvB,MAAMrB,EAAgBhB,EAASE,MAER,OAAlBc,GAICqB,EAAiBlB,QAAUH,EAAcG,SAE7CL,EAA0Bd,EAM7B,MAECc,EAA0Bd,GAI3B,OAAOJ,EAAoBY,IAAKR,EAEjC,EAWD,QAGSV","ignoreList":[]}