{"version":3,"file":"node_modules/three/src/renderers/webgl/WebGLObjects.js","names":["WebGLObjects","gl","geometries","attributes","info","updateMap","WeakMap","onInstancedMeshDispose","event","instancedMesh","target","removeEventListener","remove","instanceMatrix","instanceColor","update","object","frame","render","geometry","buffergeometry","get","set","isInstancedMesh","hasEventListener","addEventListener","ARRAY_BUFFER","isSkinnedMesh","skeleton","dispose"],"sources":["node_modules/three/src/renderers/webgl/WebGLObjects.js"],"sourcesContent":["function WebGLObjects( gl, geometries, attributes, info ) {\n\n\tlet updateMap = new WeakMap();\n\n\tfunction update( object ) {\n\n\t\tconst frame = info.render.frame;\n\n\t\tconst geometry = object.geometry;\n\t\tconst buffergeometry = geometries.get( object, geometry );\n\n\t\t// Update once per frame\n\n\t\tif ( updateMap.get( buffergeometry ) !== frame ) {\n\n\t\t\tgeometries.update( buffergeometry );\n\n\t\t\tupdateMap.set( buffergeometry, frame );\n\n\t\t}\n\n\t\tif ( object.isInstancedMesh ) {\n\n\t\t\tif ( object.hasEventListener( 'dispose', onInstancedMeshDispose ) === false ) {\n\n\t\t\t\tobject.addEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\t\t}\n\n\t\t\tif ( updateMap.get( object ) !== frame ) {\n\n\t\t\t\tattributes.update( object.instanceMatrix, gl.ARRAY_BUFFER );\n\n\t\t\t\tif ( object.instanceColor !== null ) {\n\n\t\t\t\t\tattributes.update( object.instanceColor, gl.ARRAY_BUFFER );\n\n\t\t\t\t}\n\n\t\t\t\tupdateMap.set( object, frame );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( object.isSkinnedMesh ) {\n\n\t\t\tconst skeleton = object.skeleton;\n\n\t\t\tif ( updateMap.get( skeleton ) !== frame ) {\n\n\t\t\t\tskeleton.update();\n\n\t\t\t\tupdateMap.set( skeleton, frame );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn buffergeometry;\n\n\t}\n\n\tfunction dispose() {\n\n\t\tupdateMap = new WeakMap();\n\n\t}\n\n\tfunction onInstancedMeshDispose( event ) {\n\n\t\tconst instancedMesh = event.target;\n\n\t\tinstancedMesh.removeEventListener( 'dispose', onInstancedMeshDispose );\n\n\t\tattributes.remove( instancedMesh.instanceMatrix );\n\n\t\tif ( instancedMesh.instanceColor !== null ) attributes.remove( instancedMesh.instanceColor );\n\n\t}\n\n\treturn {\n\n\t\tupdate: update,\n\t\tdispose: dispose\n\n\t};\n\n}\n\n\nexport { WebGLObjects };\n"],"mappings":"AAAA,SAASA,aAAcC,EAAIC,EAAYC,EAAYC,GAElD,IAAIC,EAAY,IAAIC,QAmEpB,SAASC,EAAwBC,GAEhC,MAAMC,EAAgBD,EAAME,OAE5BD,EAAcE,oBAAqB,UAAWJ,GAE9CJ,EAAWS,OAAQH,EAAcI,gBAEI,OAAhCJ,EAAcK,eAAyBX,EAAWS,OAAQH,EAAcK,cAE9E,CAEA,MAAO,CAENC,OA/ED,SAAiBC,GAEhB,MAAMC,EAAQb,EAAKc,OAAOD,MAEpBE,EAAWH,EAAOG,SAClBC,EAAiBlB,EAAWmB,IAAKL,EAAQG,GAoC/C,GAhCKd,EAAUgB,IAAKD,KAAqBH,IAExCf,EAAWa,OAAQK,GAEnBf,EAAUiB,IAAKF,EAAgBH,IAI3BD,EAAOO,mBAE2D,IAAjEP,EAAOQ,iBAAkB,UAAWjB,IAExCS,EAAOS,iBAAkB,UAAWlB,GAIhCF,EAAUgB,IAAKL,KAAaC,IAEhCd,EAAWY,OAAQC,EAAOH,eAAgBZ,EAAGyB,cAEf,OAAzBV,EAAOF,eAEXX,EAAWY,OAAQC,EAAOF,cAAeb,EAAGyB,cAI7CrB,EAAUiB,IAAKN,EAAQC,KAMpBD,EAAOW,cAAgB,CAE3B,MAAMC,EAAWZ,EAAOY,SAEnBvB,EAAUgB,IAAKO,KAAeX,IAElCW,EAASb,SAETV,EAAUiB,IAAKM,EAAUX,GAI3B,CAEA,OAAOG,CAER,EAuBCS,QArBD,WAECxB,EAAY,IAAIC,OAEjB,EAqBD,QAGSN","ignoreList":[]}