{"version":3,"file":"node_modules/three/src/renderers/webgl/WebGLShaderCache.js","names":["_id","WebGLShaderCache","constructor","this","shaderCache","Map","materialCache","update","material","vertexShader","fragmentShader","vertexShaderStage","_getShaderStage","fragmentShaderStage","materialShaders","_getShaderCacheForMaterial","has","add","usedTimes","remove","get","shaderStage","delete","code","getVertexShaderID","id","getFragmentShaderID","dispose","clear","cache","set","undefined","Set","stage","WebGLShaderStage"],"sources":["node_modules/three/src/renderers/webgl/WebGLShaderCache.js"],"sourcesContent":["let _id = 0;\n\nclass WebGLShaderCache {\n\n\tconstructor() {\n\n\t\tthis.shaderCache = new Map();\n\t\tthis.materialCache = new Map();\n\n\t}\n\n\tupdate( material ) {\n\n\t\tconst vertexShader = material.vertexShader;\n\t\tconst fragmentShader = material.fragmentShader;\n\n\t\tconst vertexShaderStage = this._getShaderStage( vertexShader );\n\t\tconst fragmentShaderStage = this._getShaderStage( fragmentShader );\n\n\t\tconst materialShaders = this._getShaderCacheForMaterial( material );\n\n\t\tif ( materialShaders.has( vertexShaderStage ) === false ) {\n\n\t\t\tmaterialShaders.add( vertexShaderStage );\n\t\t\tvertexShaderStage.usedTimes ++;\n\n\t\t}\n\n\t\tif ( materialShaders.has( fragmentShaderStage ) === false ) {\n\n\t\t\tmaterialShaders.add( fragmentShaderStage );\n\t\t\tfragmentShaderStage.usedTimes ++;\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tremove( material ) {\n\n\t\tconst materialShaders = this.materialCache.get( material );\n\n\t\tfor ( const shaderStage of materialShaders ) {\n\n\t\t\tshaderStage.usedTimes --;\n\n\t\t\tif ( shaderStage.usedTimes === 0 ) this.shaderCache.delete( shaderStage.code );\n\n\t\t}\n\n\t\tthis.materialCache.delete( material );\n\n\t\treturn this;\n\n\t}\n\n\tgetVertexShaderID( material ) {\n\n\t\treturn this._getShaderStage( material.vertexShader ).id;\n\n\t}\n\n\tgetFragmentShaderID( material ) {\n\n\t\treturn this._getShaderStage( material.fragmentShader ).id;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.shaderCache.clear();\n\t\tthis.materialCache.clear();\n\n\t}\n\n\t_getShaderCacheForMaterial( material ) {\n\n\t\tconst cache = this.materialCache;\n\t\tlet set = cache.get( material );\n\n\t\tif ( set === undefined ) {\n\n\t\t\tset = new Set();\n\t\t\tcache.set( material, set );\n\n\t\t}\n\n\t\treturn set;\n\n\t}\n\n\t_getShaderStage( code ) {\n\n\t\tconst cache = this.shaderCache;\n\t\tlet stage = cache.get( code );\n\n\t\tif ( stage === undefined ) {\n\n\t\t\tstage = new WebGLShaderStage( code );\n\t\t\tcache.set( code, stage );\n\n\t\t}\n\n\t\treturn stage;\n\n\t}\n\n}\n\nclass WebGLShaderStage {\n\n\tconstructor( code ) {\n\n\t\tthis.id = _id ++;\n\n\t\tthis.code = code;\n\t\tthis.usedTimes = 0;\n\n\t}\n\n}\n\nexport { WebGLShaderCache };\n"],"mappings":"AAAA,IAAIA,IAAM,EAEV,MAAMC,iBAEL,WAAAC,GAECC,KAAKC,YAAc,IAAIC,IACvBF,KAAKG,cAAgB,IAAID,GAE1B,CAEA,MAAAE,CAAQC,GAEP,MAAMC,EAAeD,EAASC,aACxBC,EAAiBF,EAASE,eAE1BC,EAAoBR,KAAKS,gBAAiBH,GAC1CI,EAAsBV,KAAKS,gBAAiBF,GAE5CI,EAAkBX,KAAKY,2BAA4BP,GAgBzD,OAdkD,IAA7CM,EAAgBE,IAAKL,KAEzBG,EAAgBG,IAAKN,GACrBA,EAAkBO,cAIiC,IAA/CJ,EAAgBE,IAAKH,KAEzBC,EAAgBG,IAAKJ,GACrBA,EAAoBK,aAIdf,IAER,CAEA,MAAAgB,CAAQX,GAEP,MAAMM,EAAkBX,KAAKG,cAAcc,IAAKZ,GAEhD,IAAM,MAAMa,KAAeP,EAE1BO,EAAYH,YAEmB,IAA1BG,EAAYH,WAAkBf,KAAKC,YAAYkB,OAAQD,EAAYE,MAMzE,OAFApB,KAAKG,cAAcgB,OAAQd,GAEpBL,IAER,CAEA,iBAAAqB,CAAmBhB,GAElB,OAAOL,KAAKS,gBAAiBJ,EAASC,cAAegB,EAEtD,CAEA,mBAAAC,CAAqBlB,GAEpB,OAAOL,KAAKS,gBAAiBJ,EAASE,gBAAiBe,EAExD,CAEA,OAAAE,GAECxB,KAAKC,YAAYwB,QACjBzB,KAAKG,cAAcsB,OAEpB,CAEA,0BAAAb,CAA4BP,GAE3B,MAAMqB,EAAQ1B,KAAKG,cACnB,IAAIwB,EAAMD,EAAMT,IAAKZ,GASrB,YAPauB,IAARD,IAEJA,EAAM,IAAIE,IACVH,EAAMC,IAAKtB,EAAUsB,IAIfA,CAER,CAEA,eAAAlB,CAAiBW,GAEhB,MAAMM,EAAQ1B,KAAKC,YACnB,IAAI6B,EAAQJ,EAAMT,IAAKG,GASvB,YAPeQ,IAAVE,IAEJA,EAAQ,IAAIC,iBAAkBX,GAC9BM,EAAMC,IAAKP,EAAMU,IAIXA,CAER,EAID,MAAMC,iBAEL,WAAAhC,CAAaqB,GAEZpB,KAAKsB,GAAKzB,MAEVG,KAAKoB,KAAOA,EACZpB,KAAKe,UAAY,CAElB,SAIQjB","ignoreList":[]}